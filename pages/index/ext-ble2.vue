<template>

	<div>
		<div>
			<text>BLE蓝牙相关接口</text>
		</div>
		<!-- split line -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>
		<!-- a list to display scan_result -->
		<view style="width: 100%; overflow-x: auto;">
			<text v-for="(item, index) in scan_result" :key="index" style="display: block; border-bottom: 1px solid #ccc; padding: 5px 0; white-space: normal;" @click="handleItemClick(item)">
				{{JSON.stringify(item)}}
			</text>
		</view>
		<div>
			<!-- heartbeat status, data length received -->
			<text>心跳状态: {{heartbeatInterval ? '开启' : '关闭'}} {{heartbeatStatusIcon}}</text>
			<text>数据长度: {{pcmDataReceived}}</text>
		</div>
		<button type="primary" @click="microphoneRecording">麦克风录音完整流程</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="initBleSDK">初始化</button>
		<button type="primary" @click="isBlueEnable">蓝牙是否开启</button>
		<button type="primary" @click="enableBluetooth">打开蓝牙</button>
		<button type="primary" @click="disableBluetooth">关闭蓝牙</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="startScan">开始扫描</button>
		<button type="primary" @click="stopScan">停止扫描</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="connect">连接</button>
		<button type="primary" @click="disconnect">断开连接</button>
		<button type="primary" @click="startHeartBeat">开启定时心跳</button>
		<button type="primary" @click="stopHeartBeat">关闭定时心跳</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="startOTA">开始OTA</button>
		<button type="primary" @click="cancelOTA">取消OTA</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="startCallingRecord">开始通话录音</button>
		<button type="primary" @click="stopCallingRecord">结束录音</button>
		<button type="primary" @click="startMicrophoneRecord">开始麦克风录音</button>
		<button type="primary" @click="sendTestData2">发送心跳</button>
		<button type="primary" @click="registerDataCallback">注册监听器</button>
		<button type="primary" @click="unRegisterDataCallback">取消注册监听器</button>
		<button type="primary" @click="decoderOpus">解码opus</button>
		<button type="primary" @click="textToRawPcm">文本文件转二进制 Pcm</button>
		<button type="primary" @click="splitChannels">分离左右声道</button>
		<button type="primary" @click="denoisePcmFile">Pcm 文件降噪</button>
		<button type="primary" @click="waveToPcm">Wav to Pcm</button>
		<button type="primary" @click="pcmToWav">Pcm to Wav</button>
		<button type="primary" @click="splitChannelsTest">分离左右声道测试</button>
		<button type="primary" @click="classicalRecord">系统通道录音</button>
		<button type="primary" @click="stopClassicalRecord">停止系统通道录音</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="requestAudioRecordPermission">请求录音权限</button>
		<button type="primary" @click="startNativeRecord">开始原生录音</button>
		<button type="primary" @click="stopNativeRecord">结束原生录音</button>
		<button type="primary" @click="exportNativeRecordFile">导出原生录音文件</button>
		<button type="primary" @click="exportNativeRecordDenoisedFile">导出原生录音降噪文件</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="exportFile">导出文本录音文件</button>
		<button type="primary" @click="exportPcmFile">导出二进制PCM录音文件</button>
		<button type="primary" @click="exportPcmLeftFile">导出声道0二进制PCM录音文件</button>
		<button type="primary" @click="exportPcmRightFile">导出声道1二进制PCM录音文件</button>
		<button type="primary" @click="exportPcmLeftDenoiseFile">导出声道0二进制PCM降噪文件</button>
		<button type="primary" @click="exportPcmRightDenoiseFile">导出声道1二进制PCM降噪文件</button>

		<!-- splitter -->
		<view style="border-bottom: 1px solid #ccc; margin: 10px 0;"></view>

		<button type="primary" @click="testDenoisePcm16k">测试 16kHz pcm 降噪</button>
	</div>
</template>

<script>
	//必须引入的Recorder核心（文件路径是 /src/recorder-core.js 下同），使用import、require都行
	import Recorder from 'recorder-core' //注意如果未引用Recorder变量，可能编译时会被优化删除（如vue3 tree-shaking），请改成 import 'recorder-core'，或随便调用一下 Recorder.a=1 保证强引用

	import 'recorder-core/src/engine/pcm.js'

	//必须引入的RecordApp核心文件（文件路径是 /src/app-support/app.js）
	import RecordApp from 'recorder-core/src/app-support/app'

	//所有平台必须引入的uni-app支持文件（如果编译出现路径错误，请把@换成 ../../ 这种）
	import '@/uni_modules/Recorder-UniCore/app-uni-support.js'
	
	// 获取 module 
	var sdkModule = uni.requireNativePlugin("XM-BesAllModule")
	// var testModule = uni.requireNativePlugin("TestModule")
	var deviceProtocol = 1 // 1:BLE, 16:SPP
	// const modal = uni.requireNativePlugin('modal');
	// 是否在录音
	var isRecording = false
	var filenameStub = 'plugin-demo-pcm'
	///
	/// 测试文件命名规则：
	/// 
	/// 坑：uniapp 不能写二进制文件，只能写字符串文件，所以录音原始数据先转成字符串保存。
	///
	/// 1. filenameStub + '.pcm'：录音原始数据，字符串格式，逗号分隔
	/// 2. filenameStub + '-left.pcm': 左声道数据，字符串格式，逗号分隔
	/// 3. filenameStub + '-right.pcm': 右声道数据，字符串格式，逗号分隔
	/// 4. filenameStub + '-left-raw.pcm': 左声道数据，二进制格式
	/// 5. filenameStub + '-right-raw.pcm': 右声道数据，二进制格式
	/// 7. filenameStub + '-left-raw-denoise.pcm': 左声道数据，二进制格式，降噪后
	/// 8. filenameStub + '-right-raw-denoise.pcm': 右声道数据，二进制格式，降噪后
	///

	// char 数据，保存录音
	var pcmData = []

	var testData = [
		[
			160, 47, 53, 13, 157, 216, 141, 247, 153, 14, 91, 246, 207, 247, 181, 8, 83,
			4, 179, 5, 114, 5, 150, 1, 70, 19, 106, 22, 154, 6, 200, 240, 88, 231, 220,
			6, 60, 23, 78, 11, 28, 9, 102, 11, 251, 10, 76, 237, 233, 221, 56, 28, 122,
			31, 78, 218, 153, 223, 120, 19, 106, 29, 138, 255, 96, 235, 59, 254, 127, 1,
			101, 243, 32, 2, 231, 12, 206, 240, 24, 242, 245, 27, 114, 29, 120, 251, 26,
			230, 77, 227, 177, 238, 185, 6, 90, 24, 238, 12, 196, 248, 121, 246, 190,
			253, 12, 11, 231, 8, 238, 228, 143, 207, 237, 240, 99, 43, 170, 38, 107,
			223, 241, 213, 184, 28, 171, 45, 208, 5, 61, 232, 204, 224, 254, 0, 42, 48,
			243, 39, 52, 234, 181, 207, 71, 6, 48, 63, 189, 29, 84, 206, 40, 191, 200,
			5, 3, 85, 213, 51, 123, 200, 182, 195, 159, 29, 54, 52, 157, 9, 220, 232,
			62, 212, 6, 219, 40, 6, 139, 37, 246, 17, 66, 230, 115, 235, 107, 7, 167,
			246, 106, 241, 184, 21, 148, 2, 214, 210, 101, 241, 128, 31, 162, 22, 30,
			254, 123, 231, 88, 231, 149, 252, 71, 6, 8, 3, 162, 251, 33, 244, 81, 250,
			121, 25, 167, 41, 79, 11, 115, 212, 173, 204, 155, 31, 85, 43, 62, 224, 66,
			250, 25, 36, 167, 253, 231, 252, 108, 3, 8, 10, 191, 37, 64, 239, 104, 207,
			28, 39, 4, 44, 130, 219, 19, 234, 217, 49, 49, 32, 53, 199, 95, 193, 124,
			49, 169, 54, 2, 212, 210, 224, 44, 33, 22, 18, 107, 245, 173, 234, 151, 250,
			103, 11, 65, 245, 62, 250, 229, 7, 123, 237, 166, 10, 70, 43, 78, 246, 62,
			217, 241, 234, 204, 245, 124, 26, 103, 28, 213, 230, 79, 241, 105, 23, 179,
			22, 9, 13, 250, 225, 4, 220, 173, 29, 197, 34, 24, 255, 164, 231, 59, 217,
			221, 23, 141, 69, 178, 251, 205, 195, 107, 222, 0, 19, 31, 56, 139, 6, 71,
			213, 70, 244, 50, 6, 53, 23, 124, 37, 53, 227, 250, 192, 91, 250, 89, 32,
			88, 39, 233, 25, 255, 230, 235, 206, 76, 6, 255, 63, 45, 36, 99, 224, 192,
			190, 178, 227, 148, 71, 215, 95, 188, 244, 244, 169, 43, 225, 193, 52, 184,
			62, 121, 251, 36, 178, 116, 206, 18, 42, 92, 64, 142, 255, 211, 196, 3, 215,
			188, 24, 80, 44, 252, 241, 35, 208, 150, 231, 52, 13, 82, 46, 175, 14, 244,
			198, 22, 202, 140, 16, 106, 51, 60, 16, 50, 220, 154, 220, 185, 252, 74, 16,
			185, 24, 97, 255, 140, 218, 196, 240, 156, 23, 74, 9, 211, 247, 158, 253,
			138, 229, 219, 230, 152, 40, 243, 31, 214, 220, 2, 231, 78, 16, 41, 26, 233,
			22, 4, 241, 228, 213, 131, 245, 244, 30, 136, 44, 190, 0, 235, 213, 117,
			255, 42, 29, 117, 240, 49, 229, 149, 5, 212, 21, 195, 16, 71, 4, 232, 254,
			71, 249, 84, 242, 200, 7, 57, 23, 46, 251, 23, 237, 95, 2, 2, 11, 59, 28,
			18, 32, 63, 242, 159, 248, 156, 21, 250, 238, 253, 243, 18, 32, 167, 11,
			180, 250, 175, 0, 250, 253, 19, 18, 246, 16, 126, 251, 79, 240, 28, 213,
			196, 251, 159, 77, 226, 30, 223, 207, 100, 224, 152, 2, 100, 14, 187, 16,
			225, 8, 121, 242, 43, 204, 71, 245, 139, 69, 55, 27, 96, 221, 244, 247, 217,
			0, 143, 242, 142, 7, 152, 8, 113, 236, 39, 243, 150, 38, 23, 44, 232, 242,
			116, 225, 142, 246, 161, 251, 54, 15, 72, 24, 209, 250, 87, 219, 173, 220,
			164, 18, 45, 53, 177, 254, 77, 186, 103, 199, 96, 25, 113, 48, 44, 239, 15,
			195, 9, 212, 178, 14, 76, 67, 115, 20, 154, 175, 198, 165, 6, 250, 251, 60,
			212, 22, 9, 213, 48, 231, 53, 12, 69, 8, 39, 4, 35, 241, 182, 215, 173, 218,
			250, 251, 4, 40, 79, 24, 69, 224, 185, 229, 252, 5, 61, 18, 239, 22, 147, 6,
			198, 229, 158, 234, 246, 38, 40, 51, 117, 239, 253, 240, 85, 45, 186, 19,
			171, 239, 206, 3, 236, 6, 20, 2, 34, 26, 225, 36, 116, 7, 181, 238, 134, 18,
			180, 36, 126, 242, 62, 238, 155, 29, 182, 36, 150, 16, 55, 237, 201, 252,
			173, 68, 19, 30, 161, 195, 25, 241, 62, 43, 152, 34, 3, 25, 219, 0, 176,
			238, 115, 6, 180, 29, 36, 31, 235, 21, 249, 247, 250, 212, 40, 234, 160, 36,
			156, 42, 117, 246, 39, 213, 127, 234, 200, 9, 152, 11, 250, 248, 183, 236,
			204, 238, 233, 233, 27, 232, 37, 251, 60, 248, 166, 225, 21, 240, 213, 5,
			215, 247, 196, 220, 253, 199, 139, 222, 24, 20, 215, 23, 18, 242, 139, 223,
			36, 211, 201, 220, 116, 8, 71, 7, 241, 232, 103, 230, 64, 235, 235, 0, 62,
			5, 120, 227, 46, 235, 209, 251, 172, 244, 112, 18, 0, 16, 134, 231, 48, 253,
			76, 7, 49, 255, 8, 36, 39, 26, 188, 245, 150, 250, 193, 1, 106, 35, 238, 60,
			19, 6, 32, 230, 59, 12, 82, 26, 38, 36, 235, 47, 159, 0, 62, 224, 254, 249,
			226, 26, 119, 45, 234, 16, 184, 218, 242, 226, 187, 20, 22, 45, 163, 36, 82,
			236, 158, 198, 174, 3, 204, 53, 169, 17, 233, 243, 57, 232, 96, 237, 109,
			47, 41, 70, 163, 243, 203, 193, 119, 234, 50, 33, 53, 54, 161, 27, 132, 237,
			52, 223, 33, 242, 2, 26, 89, 46, 162, 250, 96, 199, 65, 228, 72, 20, 238,
			20, 41, 251, 102, 234, 105, 249, 218, 10, 3, 248, 54, 247, 172, 15, 161,
			236, 116, 193, 223, 0, 209, 69, 153, 14, 11, 200, 17, 215, 199, 250, 55, 12,
			152, 13, 163, 238, 145, 211, 35, 231, 224, 14, 49, 21, 175, 245, 214, 230,
			168, 250, 183, 0, 72, 254, 58, 9, 246, 253, 254, 223, 129, 238, 28, 31, 138,
			31, 9, 247, 232, 230, 92, 239, 186, 1, 215, 17, 94, 251, 251, 221, 88, 247,
			97, 25, 27, 7, 203, 233, 60, 253, 92, 23, 31, 0, 198, 230, 163, 247, 38, 16,
			158, 32, 210, 27, 38, 241, 151, 227, 133, 20, 216, 42, 25, 252, 46, 219,
			237, 242, 195, 20, 105, 22, 56, 252, 194, 244, 8, 6, 186, 253, 113, 244,
			237, 18, 90, 19, 108, 239, 205, 244, 91, 19, 63, 32, 90, 17, 20, 245, 166,
			249, 201, 17, 95, 21, 114, 7, 82, 245, 171, 252, 121, 24, 153, 16, 229, 246,
			120, 245, 26, 254, 140, 10, 15, 12, 4, 247, 193, 241, 236, 254, 117, 249,
			188, 237, 200, 237, 221, 255, 113, 21, 100, 254, 114, 218, 48, 235, 66, 0,
			161, 244, 14, 241, 126, 245, 0, 250, 209, 1, 247, 248, 99, 248, 177, 16,
			202, 5, 163, 225, 125, 232, 234, 12, 65, 31, 13, 26, 203, 254, 134, 237,
			126, 255, 156, 15, 7, 19, 91, 15, 71, 242, 118, 241, 197, 41, 244, 54, 168,
			253, 112, 225, 201, 249, 70, 23, 251, 23, 117, 253, 242, 243, 146, 10, 44,
			17, 46, 255, 12, 239, 228, 240, 63, 11, 234, 18, 238, 240, 21, 227, 21, 254,
			168, 7, 188, 252, 19, 244, 36, 236, 112, 241, 226, 4, 83, 7, 28, 246, 93,
			246, 237, 6, 212, 3, 204, 233, 239, 226, 49, 5, 118, 35, 190, 3, 88, 214,
			120, 228, 189, 11, 18, 20, 208, 12, 114, 252, 215, 222, 31, 219, 153, 4, 73,
			39, 135, 21, 217, 236, 103, 235, 77, 254, 63, 253, 117, 0, 243, 11, 183,
			255, 26, 245, 189, 2, 47, 17, 141, 21, 20, 11, 194, 245, 166, 238, 143, 246,
			1, 0, 205, 9, 166, 14, 43, 10, 240, 6, 24, 6, 48, 251, 119, 246, 106, 10,
			247, 24, 42, 10, 142, 251, 177, 250, 255, 253, 97, 9, 19, 20, 192, 6, 172,
			237, 4, 237, 153, 2, 150, 18, 32, 18, 35, 2, 159, 245, 18, 252, 10, 4, 50,
			2, 87, 254, 190, 250, 193, 250, 223, 253, 0, 8, 225, 19, 111, 8, 220, 245,
			251, 247, 221, 247, 6, 248, 116, 255, 18, 251, 32, 1, 194, 10, 74, 243, 203,
			237, 69, 18, 83, 20, 107, 238, 91, 225, 125, 247, 124, 21, 242, 16, 15, 235,
			45, 238, 224, 16, 77, 13, 248, 243, 14, 243, 211, 250, 144, 253, 182, 5, 39,
			8, 124, 249, 171, 245, 147, 2, 210, 2, 64, 254, 21, 247, 241, 235, 215, 255,
			255, 24, 106, 6, 150, 234, 83, 239, 214, 3, 20, 22, 247, 17, 171, 241, 166,
			221, 153, 244, 93, 30, 225, 29, 154, 246, 76, 233, 3, 245, 248, 246, 26, 5,
			9, 17, 130, 10, 125, 17, 160, 8, 56, 232, 64, 237, 9, 13, 79, 26, 148, 16,
			72, 242, 255, 234, 135, 7, 80, 14, 8, 3, 45, 6, 139, 5, 23, 254, 81, 247,
			105, 246, 27, 6, 108, 6, 63, 247, 56, 8, 20, 21, 196, 249, 149, 235, 192,
			250, 108, 10, 8, 15, 64, 255, 155, 242, 30, 0, 72, 9, 16, 5, 115, 0, 184,
			250, 92, 254, 235, 10, 254, 10, 255, 4, 38, 10, 71, 13, 94, 6, 132, 255,
			215, 254, 124, 6, 68, 13, 0, 4, 251, 248, 222, 254, 254, 4, 171, 1, 191, 7,
			173, 7, 64, 244, 199, 238, 161, 246, 102, 246, 30, 254, 79, 4, 232, 247, 4,
			242, 84, 246, 209, 249, 192, 254, 235, 253, 42, 246, 173, 238, 32, 235, 235,
			241, 92, 255, 245, 5, 236, 255, 82, 246, 28, 247, 177, 255, 164, 1, 233,
			254, 252, 250, 247, 245, 58, 250, 104, 3, 76, 4, 187, 2, 92, 255, 121, 245,
			32, 243, 193, 251, 131, 4, 42, 9, 156, 3, 39, 247, 91, 245, 3, 0, 166, 5,
			201, 254, 157, 250, 71, 1, 51, 2, 159, 253, 44, 2, 101, 11, 169, 19, 91, 20,
			193, 2, 195, 247, 183, 7, 221, 20, 58, 13, 223, 254, 34, 247, 247, 3, 7, 20,
			211, 5, 50, 248, 116, 1, 126, 2, 69, 250, 120, 253, 224, 1, 24, 9, 43, 21,
			26, 16, 75, 3, 92, 3, 1, 2, 113, 254, 45, 6, 145, 5, 193, 247, 87, 249, 49,
			7, 115, 14, 26, 9, 35, 252, 80, 248, 3, 254, 180, 0, 130, 255, 154, 248,
			139, 246, 229, 2, 153, 5, 150, 251, 140, 250, 144, 255, 140, 253, 21, 245,
			70, 240, 144, 244, 180, 244, 173, 242, 154, 253, 226, 8, 255, 2, 129, 249,
			19, 249, 101, 251, 147, 249, 170, 248, 252, 249, 120, 248, 69, 249, 248, 2,
			222, 10, 243, 6, 91, 251, 127, 244, 30, 253, 87, 11, 98, 10, 61, 0, 223,
			252, 215, 1, 222, 7, 153, 4, 134, 254, 164, 254, 101, 252, 118, 252, 118, 5,
			50, 4, 52, 246, 209, 244, 75, 2, 51, 11, 175, 6, 193, 255, 169, 0, 111, 6,
			112, 11, 24, 11, 145, 4, 202, 255, 211, 1, 17, 4, 224, 1, 198, 253, 77, 249,
			144, 245, 194, 246, 224, 254, 153, 3, 172, 250, 75, 245, 87, 1, 234, 12,
			203, 6, 251, 246, 67, 239, 96, 249, 65, 8, 236, 8, 115, 254, 148, 247, 71,
			254, 231, 10, 126, 15, 41, 10, 9, 0, 172, 250, 236, 254, 48, 5, 34, 6, 241,
			255, 119, 251, 40, 3, 5, 10, 155, 2, 212, 251, 36, 253, 177, 2, 44, 10, 111,
			8, 24, 254, 115, 252, 169, 2, 232, 4, 235, 4, 23, 2, 119, 253, 98, 0, 186,
			5, 51, 4, 193, 1, 121, 2, 15, 1, 50, 255, 156, 1, 1, 3, 175, 255, 58, 253,
			105, 253, 100, 253, 20, 255, 244, 0, 125, 254, 246, 249, 53, 246, 99, 243,
			204, 241, 241, 239, 229, 240, 40, 245, 140, 241, 79, 230, 90, 225, 250, 227,
			154, 234, 69, 239, 249, 236, 202, 238, 196, 245, 42, 244, 48, 244, 160, 254,
			45, 6, 209, 4, 64, 2, 17, 6, 69, 17, 6, 23, 174, 18, 77, 17, 48, 23, 151,
			29, 161, 32, 211, 31, 74, 32, 50, 37, 39, 38, 254, 33, 41, 32, 22, 31, 27,
			26, 185, 20, 201, 18, 250, 18, 61, 17, 202, 13, 238, 9, 122, 3, 144, 252,
			14, 250, 108, 250, 232, 250, 175, 249, 224, 244, 53, 242, 48, 246, 153, 245,
			100, 237, 22, 235, 131, 237, 236, 235, 62, 236, 73, 235, 43, 229, 179, 228,
			121, 231, 252, 230, 26, 232, 95, 233, 239, 231, 40, 230, 42, 228, 168, 226,
			101, 225, 186, 226, 46, 232, 53, 235, 235, 235, 107, 237, 5, 236, 219, 234,
			110, 238, 245, 243, 36, 250, 173, 253, 216, 255, 189, 8, 229, 17, 140, 17,
			246, 16, 193, 21, 4, 25, 88, 26, 210, 27, 56, 27, 119, 26, 239, 27, 148, 28,
			160, 25, 251, 22, 193, 24, 8, 26, 231, 22, 207, 18, 188, 14, 195, 9, 236, 5,
			46, 5, 240, 5, 186, 4, 20, 4, 118, 5, 194, 4, 210, 4, 224, 7, 100, 7, 22, 7,
			5, 13, 67, 16, 253, 14, 56, 15, 183, 12, 17, 7, 88, 6, 83, 8, 92, 7, 40, 4,
			240, 255, 244, 252, 42, 253, 64, 253, 4, 249, 251, 241, 118, 237, 161, 234,
			26, 229, 7, 225, 30, 225, 193, 223, 43, 223, 149, 229, 82, 237, 217, 239, 7,
			244, 118, 252, 170, 1, 174, 3, 220, 8, 175, 12, 165, 9, 199, 4, 69, 1, 150,
			250, 246, 241, 208, 237, 152, 235, 245, 229, 58, 225, 2, 227, 115, 232, 92,
			238, 219, 244, 123, 251, 216, 2, 121, 11, 34, 17, 90, 17, 145, 18, 80, 23,
			139, 24, 181, 20, 62, 19, 65, 21, 210, 20, 174, 15, 238, 9, 179, 5, 118, 2,
			200, 1, 146, 0, 218, 250, 10, 246, 139, 242, 112, 233, 28, 223, 226, 216,
			179, 212, 206, 210, 183, 210, 50, 213, 138, 224, 118, 243, 227, 7, 251, 29,
			149, 48, 254, 59, 10, 72, 42, 81, 200, 75, 139, 59, 99, 44, 1, 33, 225, 20,
			31, 5, 155, 248, 231, 244, 68, 243, 243, 237, 84, 235, 244, 238, 240, 242,
			176, 245, 56, 251, 79, 255, 77, 253, 208, 250, 49, 253, 142, 0, 154, 0, 250,
			251, 165, 246, 30, 249, 34, 2, 128, 6, 215, 2, 163, 255, 150, 1, 111, 6, 11,
			11, 81, 12, 32, 8, 79, 4, 73, 6, 147, 5, 122, 252, 205, 240, 165, 235, 40,
			239, 60, 238, 54, 227, 231, 220, 221, 224, 107, 229, 131, 228, 112, 224,
			128, 228, 137, 237, 30, 239, 244, 241, 171, 1, 225, 16, 83, 17, 7, 11, 52,
			17, 52, 29, 121, 30, 19, 24, 19, 18, 46, 15, 199, 13, 91, 6, 161, 253, 30,
			252, 116, 251, 30, 249, 42, 251, 159, 0, 38, 1, 41, 252, 4, 254, 211, 4, 1,
			3, 148, 254, 88, 2, 230, 7, 92, 8, 118, 3, 158, 0, 206, 8, 20, 17, 213, 12,
			61, 7, 231, 10, 215, 13, 117, 9, 106, 3, 116, 3, 45, 6, 165, 1, 119, 248,
			141, 245, 99, 246, 162, 243, 52, 239, 205, 239, 128, 242, 91, 242, 114, 244,
			45, 251, 83, 255, 42, 254, 37, 252, 251, 0, 220, 8, 223, 7, 113, 0, 99, 253,
			34, 3, 8, 13, 71, 10, 21, 251, 48, 250, 6, 5, 70, 4, 245, 250, 95, 248, 234,
			251, 14, 255, 113, 253, 166, 251, 180, 253
		],

		[
			134, 0, 90, 2, 116, 251, 132, 250, 80, 2, 186, 5, 220, 1, 31, 254, 232, 254,
			43, 2, 66, 4, 135, 2, 137, 255, 80, 1, 228, 5, 4, 6, 201, 1, 129, 0, 200, 3,
			34, 5, 216, 1, 196, 1, 69, 6, 206, 6, 230, 1, 45, 255, 142, 1, 156, 5, 47,
			6, 219, 2, 128, 0, 173, 0, 128, 1, 180, 2, 87, 3, 199, 1, 141, 255, 2, 255,
			190, 255, 11, 1, 108, 2, 164, 1, 183, 253, 69, 251, 150, 254, 184, 2, 199,
			1, 162, 254, 30, 253, 90, 253, 144, 254, 75, 255, 48, 255, 97, 255, 166,
			254, 225, 252, 84, 253, 45, 0, 24, 1, 68, 254, 167, 250, 252, 250, 204, 254,
			94, 1, 87, 2, 41, 1, 70, 250, 229, 245, 34, 253, 145, 4, 101, 0, 252, 251,
			242, 254, 17, 0, 56, 251, 147, 250, 25, 0, 58, 1, 201, 252, 20, 253, 214, 0,
			206, 0, 45, 255, 222, 254, 63, 253, 130, 252, 14, 1, 14, 5, 68, 2, 29, 254,
			120, 255, 248, 1, 87, 1, 25, 1, 141, 3, 93, 4, 85, 1, 207, 254, 247, 0, 142,
			4, 113, 5, 98, 4, 125, 2, 117, 1, 143, 3, 222, 4, 233, 1, 156, 0, 92, 3, 5,
			4, 255, 0, 127, 0, 69, 3, 62, 3, 179, 255, 230, 254, 10, 1, 150, 1, 63, 0,
			173, 254, 113, 253, 230, 254, 196, 1, 138, 255, 230, 251, 251, 253, 194,
			253, 126, 245, 135, 245, 251, 1, 203, 6, 74, 253, 4, 249, 158, 253, 177,
			250, 194, 242, 143, 250, 209, 8, 226, 4, 226, 247, 108, 250, 151, 1, 203,
			252, 191, 249, 218, 2, 96, 5, 212, 252, 81, 253, 139, 5, 61, 2, 201, 251,
			64, 1, 210, 4, 35, 255, 95, 0, 222, 8, 212, 5, 41, 252, 54, 254, 62, 7, 235,
			5, 138, 0, 222, 2, 230, 5, 158, 1, 34, 255, 226, 2, 62, 4, 9, 1, 163, 1,
			252, 3, 79, 1, 73, 255, 172, 2, 61, 3, 215, 254, 138, 254, 191, 2, 201, 2,
			179, 254, 50, 254, 159, 0, 173, 255, 217, 253, 53, 0, 21, 2, 32, 0, 90, 254,
			181, 253, 238, 252, 104, 254, 78, 1, 211, 0, 178, 253, 137, 253, 89, 255,
			169, 253, 50, 251, 255, 253, 97, 1, 7, 255, 205, 251, 98, 253, 210, 255,
			160, 254, 133, 252, 81, 253, 118, 254, 199, 252, 169, 251, 218, 253, 198,
			255, 76, 0, 55, 0, 37, 252, 106, 247, 240, 250, 74, 2, 202, 1, 222, 253,
			229, 254, 241, 255, 15, 252, 251, 250, 11, 0, 243, 2, 148, 0, 104, 255, 161,
			0, 18, 1, 36, 1, 226, 0, 122, 255, 130, 255, 85, 2, 139, 4, 159, 3, 131, 1,
			37, 2, 102, 3, 158, 1, 8, 1, 6, 5, 177, 6, 73, 3, 200, 0, 144, 2, 175, 4,
			117, 4, 231, 3, 47, 4, 93, 3, 143, 2, 143, 3, 238, 3, 218, 2, 0, 3, 235, 3,
			98, 3, 151, 2, 7, 3, 186, 2, 49, 0, 110, 255, 102, 2, 22, 4, 37, 2, 20, 0,
			82, 254, 254, 252, 87, 254, 97, 0, 25, 0, 190, 254, 219, 253, 39, 253, 216,
			251, 213, 250, 176, 252, 135, 255, 84, 254, 53, 251, 65, 251, 57, 253, 98,
			253, 254, 251, 189, 251, 210, 253, 248, 254, 73, 253, 21, 252, 121, 253, 54,
			255, 147, 255, 54, 254, 245, 252, 25, 254, 142, 255, 8, 255, 42, 254, 244,
			254, 153, 0, 40, 0, 73, 253, 63, 253, 5, 0, 143, 255, 241, 252, 250, 253,
			206, 255, 117, 254, 15, 253, 245, 253, 164, 253, 196, 251, 161, 252, 245,
			254, 100, 252, 175, 247, 62, 250, 219, 2, 185, 3, 76, 249, 106, 242, 208,
			249, 199, 1, 162, 0, 102, 255, 18, 1, 160, 253, 13, 249, 205, 250, 68, 0,
			37, 5, 250, 5, 129, 0, 51, 252, 100, 0, 69, 6, 114, 5, 172, 0, 129, 1, 71,
			8, 18, 10, 50, 4, 210, 2, 199, 6, 190, 6, 207, 4, 239, 7, 38, 12, 126, 11,
			23, 7, 250, 4, 235, 6, 217, 9, 171, 11, 169, 11, 16, 10, 26, 9, 36, 10, 145,
			10, 131, 8, 39, 8, 185, 10, 52, 9, 107, 5, 58, 7, 48, 10, 63, 7, 156, 2,
			211, 255, 4, 255, 63, 0, 166, 0, 27, 255, 60, 253, 163, 250, 11, 248, 113,
			246, 92, 243, 167, 239, 91, 239, 151, 239, 33, 236, 79, 234, 105, 242, 184,
			250, 31, 241, 123, 220, 33, 218, 149, 235, 245, 246, 17, 243, 147, 241, 70,
			246, 34, 242, 174, 231, 47, 236, 56, 252, 179, 1, 55, 251, 28, 250, 235,
			254, 5, 2, 209, 5, 110, 7, 167, 1, 246, 0, 151, 12, 113, 19, 40, 13, 10, 10,
			111, 15, 198, 13, 251, 6, 153, 11, 72, 21, 226, 19, 147, 11, 92, 7, 134, 9,
			173, 12, 249, 11, 191, 10, 29, 10, 86, 6, 104, 2, 171, 2, 247, 3, 30, 3, 20,
			2, 52, 1, 230, 254, 22, 254, 135, 0, 40, 0, 186, 251, 171, 250, 142, 255,
			60, 2, 198, 255, 195, 254, 143, 255, 147, 252, 119, 251, 150, 1, 214, 6, 17,
			5, 25, 1, 178, 0, 211, 2, 176, 2, 128, 2, 12, 6, 5, 8, 219, 4, 18, 3, 216,
			4, 3, 5, 195, 3, 221, 3, 174, 2, 128, 0, 53, 2, 13, 4, 84, 0, 230, 251, 57,
			252, 8, 253, 145, 251, 109, 250, 244, 250, 219, 250, 124, 247, 197, 242,
			215, 242, 169, 247, 9, 251, 162, 248, 61, 242, 23, 239, 139, 242, 140, 246,
			52, 245, 1, 244, 178, 247, 127, 249, 35, 244, 165, 241, 129, 247, 233, 251,
			33, 249, 234, 246, 166, 249, 41, 254, 157, 254, 189, 249, 34, 248, 195, 253,
			176, 1, 39, 0, 17, 255, 8, 0, 159, 0, 194, 255, 152, 255, 130, 2, 183, 5,
			37, 5, 34, 2, 162, 0, 162, 3, 77, 8, 147, 8, 98, 6, 215, 7, 68, 10, 69, 8,
			154, 6, 129, 10, 4, 15, 43, 15, 38, 13, 94, 12, 106, 14, 186, 16, 185, 15,
			245, 13, 14, 16, 164, 18, 30, 17, 85, 14, 129, 14, 137, 15, 183, 14, 246,
			11, 177, 8, 134, 8, 57, 10, 171, 7, 43, 3, 46, 3, 225, 2, 87, 254, 71, 250,
			39, 248, 204, 246, 118, 247, 124, 247, 68, 244, 8, 241, 174, 238, 84, 236,
			41, 236, 40, 238, 120, 239, 172, 238, 85, 236, 59, 235, 110, 237, 236, 240,
			171, 242, 61, 242, 145, 241, 211, 243, 15, 248, 162, 249, 67, 249, 15, 251,
			185, 254, 60, 0, 214, 255, 112, 1, 245, 4, 96, 6, 34, 5, 104, 4, 227, 6, 58,
			9, 46, 8, 12, 7, 227, 6, 59, 6, 13, 7, 29, 7, 142, 4, 92, 4, 200, 5, 230, 3,
			221, 255, 182, 254, 196, 0, 148, 0, 246, 251, 85, 249, 153, 252, 55, 1, 26,
			0, 18, 249, 87, 245, 124, 248, 249, 251, 126, 252, 78, 254, 185, 0, 128,
			254, 219, 248, 143, 247, 214, 252, 48, 3, 26, 4, 118, 0, 19, 255, 109, 2,
			52, 5, 37, 4, 96, 3, 254, 5, 205, 8, 9, 8, 40, 6, 44, 7, 130, 9, 212, 8, 44,
			7, 59, 9, 18, 13, 207, 12, 109, 9, 191, 7, 167, 8, 30, 10, 151, 11, 127, 12,
			228, 11, 230, 10, 163, 10, 32, 10, 245, 9, 5, 12, 247, 12, 244, 8, 112, 4,
			24, 6, 185, 9, 187, 8, 73, 5, 18, 4, 24, 3, 0, 0, 234, 252, 113, 251, 11,
			250, 115, 248, 123, 247, 63, 246, 253, 243, 112, 241, 2, 238, 72, 232, 179,
			226, 35, 226, 19, 230, 84, 232, 48, 231, 170, 231, 97, 233, 183, 227, 174,
			215, 255, 214, 35, 231, 244, 244, 103, 242, 98, 236, 79, 238, 15, 240, 198,
			235, 1, 240, 195, 255, 216, 7, 29, 3, 232, 1, 201, 5, 9, 7, 144, 8, 213, 13,
			106, 18, 135, 20, 11, 23, 208, 24, 96, 22, 85, 19, 127, 22, 255, 26, 72, 25,
			136, 23, 191, 27, 24, 27, 211, 17, 129, 13, 115, 18, 226, 19, 133, 15, 55,
			13, 109, 12, 118, 8, 130, 4, 208, 3, 193, 3, 93, 2, 204, 1, 233, 0, 209,
			252, 255, 249, 118, 251, 184, 251, 53, 250, 249, 251, 134, 253, 21, 251, 29,
			249, 192, 250, 54, 252, 180, 251, 29, 252, 13, 255, 240, 0, 234, 255, 150,
			254, 91, 254, 176, 254, 60, 0, 210, 2, 129, 4, 109, 3, 60, 1, 61, 1, 112, 1,
			175, 255, 145, 255, 206, 0, 57, 0, 227, 254, 84, 253, 188, 251, 30, 251,
			198, 249, 233, 247, 209, 247, 114, 248, 124, 248, 202, 247, 193, 244, 97,
			241, 151, 242, 149, 245, 78, 245, 111, 244, 16, 246, 213, 244, 11, 240, 110,
			240, 232, 246, 136, 248, 46, 245, 193, 245, 153, 248, 235, 246, 85, 245, 28,
			249, 220, 252, 76, 252, 219, 251, 53, 253, 255, 252, 100, 252, 8, 254, 178,
			255, 87, 0, 158, 2, 146, 4, 152, 2, 17, 0, 158, 1, 244, 3, 64, 4, 159, 5,
			162, 8, 217, 8, 39, 6, 65, 5, 102, 7, 141, 9, 236, 10, 32, 12, 125, 12, 20,
			12, 193, 11, 5, 12, 38, 13, 184, 14, 194, 15, 109, 15, 127, 14, 144, 14,
			136, 14, 161, 13, 168, 13, 25, 14, 196, 13, 49, 13, 176, 11, 140, 9, 52, 8,
			218, 6, 75, 5, 113, 4, 70, 3, 108, 1, 85, 255, 98, 252, 181, 249, 230, 248,
			134, 248, 228, 246, 176, 244, 249, 242, 115, 242, 15, 242, 77, 240, 118,
			239, 13, 241, 81, 241, 165, 239, 126, 239, 212, 240, 185, 241, 195, 242, 71,
			244, 120, 245, 236, 245, 99, 246, 3, 248, 133, 250, 143, 252, 151, 253, 194,
			253, 77, 254, 69, 0, 28, 2, 248, 2, 180, 3, 255, 3, 244, 3, 143, 4, 44, 5,
			76, 5, 30, 5, 38, 4, 58, 3, 59, 3, 30, 3, 189, 2, 93, 2, 30, 1, 181, 255,
			152, 255, 141, 255, 1, 254, 50, 252, 5, 252, 59, 253, 131, 253, 189, 251,
			145, 251, 223, 254, 82, 255, 46, 249, 219, 246, 125, 253, 171, 2, 107, 0,
			242, 254, 168, 0, 127, 0, 109, 254, 105, 255, 216, 3, 27, 7, 3, 6, 245, 2,
			24, 2, 3, 5, 12, 8, 25, 7, 135, 5, 101, 7, 230, 8, 87, 6, 133, 4, 0, 7, 65,
			9, 96, 7, 85, 5, 196, 6, 220, 8, 72, 7, 5, 4, 225, 3, 143, 6, 227, 7, 101,
			7, 159, 6, 191, 5, 15, 5, 34, 5, 180, 5, 248, 6, 193, 8, 252, 7, 110, 4,
			119, 3, 200, 5, 10, 6, 209, 4, 94, 4, 163, 3, 43, 3, 209, 2, 8, 1, 22, 255,
			245, 253, 66, 252, 246, 249, 251, 248, 57, 249, 40, 248, 164, 245, 88, 243,
			228, 240, 218, 237, 192, 234, 98, 233, 250, 235, 203, 237, 254, 233, 181,
			231, 163, 235, 93, 235, 146, 228, 164, 227, 11, 236, 187, 241, 204, 239, 44,
			239, 96, 244, 149, 245, 153, 241, 193, 243, 85, 252, 48, 1, 101, 2, 81, 3,
			144, 3, 116, 5, 194, 9, 109, 12, 28, 13, 218, 15, 94, 19, 13, 19, 6, 17,
			109, 19, 193, 22, 225, 20, 168, 18, 99, 21, 41, 23, 41, 20, 23, 17, 193, 16,
			126, 16, 4, 15, 24, 13, 108, 11, 197, 10, 220, 9, 143, 6, 124, 3, 132, 3,
			14, 4, 77, 2, 233, 255, 199, 254, 161, 253, 221, 251, 181, 251, 233, 252,
			91, 253, 205, 252, 161, 251, 10, 251, 237, 251, 154, 252, 102, 252, 158,
			252, 141, 253, 84, 255, 144, 0, 96, 255, 205, 253, 120, 254, 25, 0, 119, 0,
			141, 0, 190, 1, 91, 2, 222, 0, 47, 255, 218, 254, 245, 254, 110, 254, 187,
			253, 162, 253, 48, 254, 68, 254, 105, 252, 175, 249, 209, 248, 231, 248,
			134, 247, 200, 246, 73, 249, 148, 251, 16, 249, 107, 244, 180, 243, 118,
			246, 23, 248, 108, 248, 155, 248, 96, 248, 42, 248, 227, 247, 201, 247, 146,
			249, 208, 251, 226, 251, 46, 251, 228, 251, 40, 253, 225, 253, 240, 253, 75,
			254, 228, 255, 81, 1, 50, 1, 205, 0, 113, 1, 122, 2, 194, 2, 75, 2, 30, 3,
			77, 5, 211, 5, 38, 4, 86, 3, 122, 4, 231, 5, 33, 6, 114, 6, 115, 7, 166, 6,
			20, 5, 195, 6, 12, 9, 70, 8, 194, 6, 124, 7, 23, 9, 190, 9, 164, 9, 114, 9,
			205, 8, 46, 8, 99, 8, 26, 9, 67, 10, 245, 10, 5, 9, 4, 6, 247, 5, 150, 7,
			94, 7, 160, 5, 198, 4, 184, 4, 130, 3, 77, 1, 255, 255, 90, 255, 162, 254,
			102, 253, 7, 252, 234, 251, 72, 251, 143, 248, 114, 246, 87, 245, 8, 245,
			89, 246, 134, 246, 26, 245, 144, 244, 214, 243, 253, 241, 187, 241, 115,
			244, 64, 247, 133, 246, 15, 245, 92, 246, 30, 248, 193, 247, 248, 247, 237,
			250, 164, 253, 209, 252, 223, 251, 11, 254, 165, 0, 131, 0, 180, 255, 97, 1,
			187, 3, 54, 3, 93, 2, 179, 3, 155, 4, 225, 3, 47, 3, 31, 3, 38, 4, 30, 5,
			253, 3, 108, 2, 26, 2, 120, 2, 231, 2, 30, 2, 2, 1, 230, 1, 202, 1, 72, 255,
			17, 255, 72, 1, 152, 1, 107, 0, 127, 255, 68, 255, 255, 255, 129, 0, 100, 0,
			210, 0, 159, 1, 231, 1, 180, 1, 83, 1, 167, 1, 252, 2, 200, 3, 61, 3, 255,
			2, 178, 3, 190, 3, 85, 3, 224, 3, 56, 4, 151, 3, 159, 3, 57, 4, 200, 3, 59,
			3, 0, 3, 166, 2, 254, 2, 177, 2, 246, 1, 226, 2, 246, 1, 12, 0, 123, 1, 235,
			1, 103, 0, 238, 0, 112, 0, 96, 255, 121, 0, 165, 0, 211, 255, 98, 255, 32,
			0, 110, 1, 223, 255, 81, 254, 115, 255, 174, 254, 182, 255, 94, 3, 205, 0,
			99, 254, 189, 0, 250, 253, 60, 251, 151, 255, 23, 0, 2, 254, 252, 255, 7,
			255, 164, 251, 45, 250, 196, 249, 110, 251, 10, 252, 144, 249, 14, 249, 40,
			250, 235, 248, 244, 246, 102, 247, 125, 249, 11, 249, 117, 246, 55, 246,
			243, 247, 159, 249, 179, 250, 6, 249, 237, 247, 236, 250, 193, 251, 26, 250,
			100, 253, 234, 0, 60, 255, 65, 253, 186, 254, 121, 1, 219, 2, 173, 2, 70, 3,
			37, 4, 71, 4, 73, 5, 86, 6, 83, 6, 243, 6, 126, 7, 228, 6, 1, 7, 53, 8, 72,
			9, 131, 8, 56, 6, 92, 6, 24, 8, 230, 6, 90, 5, 59, 6, 68, 6, 238, 4, 222, 4,
			225, 4, 93, 3, 43, 2, 191, 2, 139, 2, 209, 0, 164, 0, 122, 1, 203, 0, 206,
			0, 236, 0, 60, 254, 14, 253, 185, 255, 154, 1, 61, 255, 140, 252, 186, 254,
			136, 0, 64, 253, 168, 253, 0, 0, 185, 253, 34, 254, 190, 255, 216, 252, 124,
			253, 84, 0, 198, 253, 113, 252, 2, 254, 67, 254, 193, 254, 150, 253, 70,
			251, 151, 252, 107, 253, 113, 252, 218, 253, 5, 254, 38, 252, 241, 252, 134,
			253, 214, 252, 94, 253, 32, 252, 30, 251, 169, 254, 230, 255, 190, 251, 119,
			251, 94, 255, 95, 254, 61, 253, 212, 0, 196, 0, 92, 253, 236, 254, 15, 0
		],

		[
			57, 0, 209, 1, 165, 3, 52, 5, 191, 4, 17, 2, 59, 255, 179, 253, 181, 253,
			10, 255, 148, 0, 254, 0, 157, 0, 202, 0, 217, 0, 74, 255, 168, 252, 223,
			250, 238, 250, 57, 253, 36, 1, 169, 3, 143, 2, 77, 0, 98, 0, 159, 1, 24, 0,
			65, 252, 154, 250, 58, 254, 199, 4, 239, 8, 150, 7, 33, 3, 168, 0, 162, 0,
			88, 255, 130, 251, 215, 248, 31, 250, 194, 253, 72, 0, 166, 255, 165, 252,
			32, 250, 119, 250, 184, 252, 47, 254, 106, 254, 194, 254, 143, 255, 55, 0,
			229, 0, 248, 1, 97, 3, 84, 5, 16, 8, 134, 10, 115, 10, 207, 6, 236, 0, 108,
			251, 82, 248, 149, 247, 170, 248, 202, 251, 103, 0, 104, 3, 89, 2, 183, 254,
			240, 251, 187, 250, 209, 249, 201, 249, 185, 252, 155, 2, 165, 8, 201, 11,
			233, 10, 244, 7, 105, 5, 117, 3, 114, 1, 86, 0, 213, 0, 182, 1, 198, 1, 22,
			1, 191, 255, 226, 253, 97, 252, 195, 251, 175, 251, 62, 252, 122, 253, 39,
			254, 124, 253, 185, 252, 94, 253, 135, 255, 108, 2, 16, 5, 97, 6, 158, 6,
			18, 7, 205, 6, 135, 3, 10, 254, 128, 250, 219, 250, 49, 253, 156, 254, 32,
			254, 223, 252, 139, 252, 128, 253, 2, 254, 194, 252, 208, 250, 150, 250, 47,
			253, 253, 0, 39, 3, 101, 2, 200, 0, 189, 0, 185, 1, 217, 1, 163, 0, 159,
			254, 161, 252, 123, 252, 226, 254, 250, 0, 40, 0, 206, 253, 157, 253, 85, 0,
			231, 2, 45, 2, 195, 254, 161, 252, 4, 254, 97, 1, 76, 3, 35, 2, 137, 255,
			80, 254, 66, 255, 41, 0, 83, 255, 200, 253, 46, 254, 171, 1, 87, 6, 0, 9,
			193, 7, 113, 3, 193, 254, 59, 252, 28, 252, 167, 251, 157, 249, 134, 249,
			85, 255, 240, 7, 89, 11, 202, 6, 104, 255, 252, 251, 52, 253, 208, 254, 87,
			253, 42, 251, 235, 253, 155, 5, 35, 11, 197, 8, 80, 2, 126, 254, 232, 254,
			232, 255, 173, 254, 178, 252, 39, 253, 171, 0, 136, 3, 101, 2, 117, 254,
			173, 251, 179, 251, 4, 253, 190, 253, 111, 253, 191, 253, 23, 0, 232, 2,
			171, 3, 49, 3, 128, 3, 233, 3, 10, 3, 145, 1, 100, 0, 89, 255, 85, 254, 78,
			253, 106, 252, 208, 252, 149, 254, 223, 254, 136, 252, 15, 251, 8, 253, 87,
			255, 144, 254, 105, 252, 36, 252, 107, 254, 93, 1, 183, 2, 10, 2, 18, 2, 75,
			4, 163, 5, 213, 3, 135, 1, 24, 1, 128, 0, 19, 254, 157, 251, 67, 251, 193,
			252, 190, 254, 220, 255, 202, 255, 1, 0, 131, 1, 122, 2, 173, 0, 184, 253,
			201, 252, 121, 254, 200, 0, 65, 2, 212, 2, 20, 3, 116, 3, 87, 3, 209, 1,
			109, 255, 236, 253, 231, 253, 199, 254, 243, 255, 155, 0, 9, 0, 244, 254,
			179, 254, 49, 255, 124, 255, 202, 255, 139, 0, 54, 1, 74, 1, 232, 0, 242,
			255, 85, 254, 29, 253, 158, 253, 231, 255, 119, 2, 111, 3, 144, 2, 73, 1,
			101, 0, 149, 254, 153, 251, 8, 250, 192, 251, 220, 254, 8, 1, 87, 2, 74, 3,
			149, 3, 63, 3, 83, 2, 166, 0, 127, 255, 133, 0, 113, 2, 120, 2, 230, 0, 120,
			0, 93, 1, 137, 1, 11, 0, 225, 253, 151, 252, 203, 253, 49, 1, 76, 3, 35, 2,
			79, 0, 253, 0, 194, 2, 208, 2, 34, 1, 130, 255, 41, 255, 77, 0, 173, 1, 69,
			1, 141, 255, 236, 254, 124, 255, 52, 255, 20, 254, 235, 253, 166, 254, 209,
			254, 110, 254, 149, 254, 61, 255, 122, 255, 248, 254, 62, 254, 219, 253,
			209, 253, 77, 253, 227, 251, 253, 250, 109, 252, 81, 255, 187, 0, 73, 0, 28,
			0, 5, 1, 97, 1, 113, 0, 50, 255, 131, 254, 143, 254, 127, 255, 172, 0, 112,
			0, 163, 254, 26, 253, 250, 252, 207, 253, 138, 254, 65, 254, 130, 253, 190,
			254, 85, 2, 36, 4, 86, 1, 138, 253, 8, 254, 119, 1, 103, 3, 224, 2, 110, 2,
			249, 3, 243, 6, 39, 8, 224, 4, 251, 255, 53, 254, 175, 255, 91, 0, 252, 254,
			249, 253, 233, 254, 152, 0, 91, 1, 7, 1, 154, 0, 235, 0, 102, 1, 107, 1,
			136, 1, 22, 2, 26, 2, 38, 1, 82, 0, 191, 0, 252, 1, 174, 2, 243, 1, 117, 0,
			38, 0, 94, 1, 226, 1, 11, 0, 201, 253, 160, 253, 14, 255, 134, 255, 240,
			253, 31, 252, 155, 252, 88, 255, 208, 0, 19, 255, 218, 252, 166, 253, 142,
			0, 190, 1, 252, 255, 146, 253, 122, 253, 131, 255, 140, 0, 101, 254, 127,
			251, 228, 251, 209, 254, 63, 0, 4, 255, 254, 253, 218, 254, 110, 0, 187, 0,
			57, 255, 106, 253, 46, 253, 61, 254, 159, 254, 21, 254, 60, 254, 213, 255,
			116, 1, 220, 1, 159, 1, 215, 1, 19, 2, 71, 1, 224, 255, 102, 255, 151, 0,
			68, 2, 135, 2, 13, 1, 50, 0, 149, 1, 34, 3, 237, 1, 235, 254, 182, 253, 76,
			255, 124, 1, 6, 2, 71, 1, 75, 1, 101, 3, 253, 5, 235, 5, 211, 2, 165, 255,
			177, 254, 165, 254, 145, 253, 228, 251, 218, 251, 144, 254, 138, 2, 6, 5,
			170, 4, 12, 3, 197, 1, 63, 0, 160, 253, 44, 251, 76, 250, 160, 250, 154,
			251, 166, 253, 103, 0, 79, 2, 96, 2, 64, 1, 68, 0, 46, 0, 108, 0, 130, 255,
			142, 253, 183, 252, 36, 254, 172, 255, 196, 254, 122, 252, 82, 252, 154,
			255, 23, 3, 161, 3, 173, 1, 86, 0, 215, 0, 34, 1, 16, 255, 240, 251, 155,
			251, 6, 255, 176, 2, 210, 2, 130, 0, 85, 255, 29, 0, 146, 0, 95, 255, 244,
			253, 58, 254, 105, 0, 164, 2, 17, 3, 239, 1, 14, 1, 53, 1, 155, 1, 212, 1,
			225, 1, 83, 1, 17, 0, 253, 254, 213, 254, 55, 255, 114, 255, 150, 255, 27,
			0, 42, 1, 62, 2, 125, 2, 90, 1, 110, 255, 101, 254, 254, 254, 48, 0, 176, 0,
			182, 0, 13, 1, 203, 1, 85, 2, 223, 1, 94, 0, 33, 255, 134, 255, 187, 0, 247,
			0, 225, 255, 160, 254, 36, 254, 36, 254, 218, 253, 72, 253, 109, 253, 179,
			254, 58, 0, 210, 0, 35, 0, 8, 255, 167, 254, 46, 255, 158, 255, 141, 255,
			177, 255, 76, 0, 173, 0, 164, 0, 128, 0, 252, 255, 1, 255, 173, 254, 73,
			255, 117, 255, 142, 254, 155, 253, 226, 252, 55, 252, 122, 252, 200, 253,
			199, 254, 46, 255, 246, 255, 228, 0, 37, 1, 233, 0, 152, 0, 53, 0, 56, 0,
			228, 0, 117, 1, 92, 1, 19, 1, 212, 0, 101, 0, 17, 0, 32, 0, 71, 0, 159, 0,
			164, 1, 156, 2, 115, 2, 131, 1, 219, 0, 188, 0, 38, 1, 215, 1, 202, 1, 21,
			1, 88, 1, 223, 2, 93, 3, 134, 1, 240, 254, 169, 253, 20, 254, 5, 255, 114,
			255, 107, 255, 36, 0, 17, 2, 169, 3, 89, 3, 186, 1, 131, 0, 218, 255, 243,
			254, 203, 253, 7, 253, 192, 252, 167, 252, 213, 252, 168, 253, 198, 254, 47,
			255, 112, 254, 175, 253, 72, 254, 210, 255, 147, 0, 7, 0, 164, 255, 125, 0,
			185, 1, 154, 1, 40, 0, 67, 255, 34, 0, 100, 1, 4, 1, 91, 255, 95, 254, 249,
			254, 168, 255, 183, 254, 160, 252, 53, 252, 169, 254, 108, 1, 175, 1, 62, 0,
			59, 0, 117, 2, 167, 4, 42, 4, 175, 1, 139, 0, 57, 2, 220, 3, 52, 2, 228,
			254, 10, 254, 131, 0, 104, 2, 236, 0, 4, 254, 126, 253, 147, 255, 183, 0,
			245, 254, 165, 252, 83, 253, 50, 0, 127, 1, 232, 255, 167, 254, 68, 0, 200,
			2, 226, 2, 189, 0, 128, 255, 72, 0, 40, 1, 4, 0, 178, 253, 125, 252, 69,
			253, 108, 254, 60, 254, 104, 253, 202, 253, 138, 255, 201, 0, 149, 0, 215,
			255, 199, 255, 80, 0, 151, 0, 61, 0, 220, 255, 68, 0, 44, 1, 131, 1, 237, 0,
			101, 0, 159, 0, 237, 0, 93, 0, 98, 255, 46, 255, 215, 255, 43, 0, 100, 255,
			98, 254, 120, 254, 156, 255, 46, 0, 116, 255, 184, 254, 113, 255, 24, 1,
			247, 1, 161, 1, 47, 1, 204, 1, 6, 3, 90, 3, 42, 2, 200, 0, 139, 0, 210, 0,
			66, 0, 207, 254, 188, 253, 224, 253, 211, 254, 109, 255, 62, 255, 43, 255,
			20, 0, 90, 1, 118, 1, 122, 0, 225, 255, 87, 0, 15, 1, 19, 1, 95, 0, 244,
			255, 134, 0, 85, 1, 107, 1, 200, 0, 36, 0, 3, 0, 22, 0, 138, 255, 48, 254,
			233, 252, 108, 252, 177, 252, 70, 253, 215, 253, 159, 254, 3, 0, 142, 1, 66,
			2, 239, 1, 40, 1, 193, 0, 243, 0, 207, 0, 174, 255, 152, 254, 164, 254, 71,
			255, 123, 255, 227, 254, 58, 254, 106, 254, 67, 255, 202, 255, 142, 255, 26,
			255, 65, 255, 235, 255, 45, 0, 244, 255, 207, 255, 1, 0, 123, 0, 11, 1, 98,
			1, 102, 1, 85, 1, 59, 1, 236, 0, 140, 0, 100, 0, 65, 0, 197, 255, 30, 255,
			247, 254, 112, 255, 209, 255, 151, 255, 119, 255, 68, 0, 122, 1, 8, 2, 197,
			1, 112, 1, 116, 1, 148, 1, 75, 1, 137, 0, 237, 255, 5, 0, 115, 0, 75, 0,
			125, 255, 240, 254, 91, 255, 43, 0, 99, 0, 226, 255, 96, 255, 92, 255, 134,
			255, 69, 255, 105, 254, 171, 253, 24, 254, 186, 255, 61, 1, 132, 1, 40, 1,
			45, 1, 121, 1, 30, 1, 247, 255, 202, 254, 102, 254, 216, 254, 79, 255, 26,
			255, 134, 254, 108, 254, 216, 254, 31, 255, 8, 255, 21, 255, 157, 255, 92,
			0, 223, 0, 218, 0, 97, 0, 211, 255, 123, 255, 68, 255, 50, 255, 128, 255,
			33, 0, 209, 0, 86, 1, 121, 1, 39, 1, 130, 0, 186, 255, 52, 255, 56, 255,
			134, 255, 194, 255, 240, 255, 74, 0, 237, 0, 127, 1, 153, 1, 38, 1, 113, 0,
			35, 0, 72, 0, 33, 0, 127, 255, 35, 255, 138, 255, 77, 0, 187, 0, 169, 0,
			132, 0, 183, 0, 47, 1, 65, 1, 168, 0, 250, 255, 175, 255, 171, 255, 180,
			255, 183, 255, 180, 255, 174, 255, 176, 255, 205, 255, 254, 255, 2, 0, 182,
			255, 116, 255, 162, 255, 252, 255, 232, 255, 96, 255, 248, 254, 100, 255,
			128, 0, 57, 1, 242, 0, 79, 0, 75, 0, 174, 0, 102, 0, 30, 255, 236, 253, 237,
			253, 230, 254, 165, 255, 125, 255, 41, 255, 144, 255, 140, 0, 29, 1, 214, 0,
			87, 0, 100, 0, 220, 0, 211, 0, 249, 255, 12, 255, 235, 254, 112, 255, 222,
			255, 225, 255, 236, 255, 124, 0, 51, 1, 39, 1, 21, 0, 3, 255, 224, 254, 85,
			255, 111, 255, 6, 255, 1, 255, 242, 255, 24, 1, 59, 1, 137, 0, 40, 0, 170,
			0, 90, 1, 43, 1, 49, 0, 122, 255, 145, 255, 200, 255, 111, 255, 176, 254,
			100, 254, 4, 255, 2, 0, 117, 0, 71, 0, 35, 0, 66, 0, 97, 0, 79, 0, 29, 0, 4,
			0, 29, 0, 68, 0, 109, 0, 147, 0, 133, 0, 71, 0, 36, 0, 47, 0, 73, 0, 59, 0,
			231, 255, 162, 255, 184, 255, 221, 255, 178, 255, 119, 255, 166, 255, 65, 0,
			171, 0, 152, 0, 112, 0, 158, 0, 0, 1, 43, 1, 235, 0, 126, 0, 77, 0, 98, 0,
			90, 0, 229, 255, 76, 255, 26, 255, 75, 255, 110, 255, 80, 255, 53, 255, 95,
			255, 189, 255, 14, 0, 44, 0, 60, 0, 127, 0, 219, 0, 239, 0, 185, 0, 132, 0,
			106, 0, 62, 0, 211, 255, 80, 255, 13, 255, 6, 255, 253, 254, 241, 254, 4,
			255, 75, 255, 166, 255, 216, 255, 244, 255, 50, 0, 99, 0, 86, 0, 40, 0, 14,
			0, 28, 0, 23, 0, 206, 255, 135, 255, 149, 255, 217, 255, 250, 255, 196, 255,
			118, 255, 128, 255, 221, 255, 9, 0, 218, 255, 169, 255, 209, 255, 36, 0, 44,
			0, 222, 255, 139, 255, 121, 255, 165, 255, 214, 255, 229, 255, 241, 255, 36,
			0, 102, 0, 127, 0, 105, 0, 78, 0, 61, 0, 22, 0, 247, 255, 25, 0, 58, 0, 14,
			0, 223, 255, 249, 255, 57, 0, 106, 0, 97, 0, 41, 0, 13, 0, 36, 0, 51, 0, 18,
			0, 217, 255, 197, 255, 25, 0, 160, 0, 221, 0, 193, 0, 127, 0, 78, 0, 70, 0,
			44, 0, 214, 255, 142, 255, 184, 255, 53, 0, 134, 0, 90, 0, 11, 0, 7, 0, 74,
			0, 109, 0, 43, 0, 226, 255, 0, 0, 87, 0, 93, 0, 246, 255, 121, 255, 112,
			255, 233, 255, 55, 0, 23, 0, 241, 255, 20, 0, 78, 0, 75, 0, 227, 255, 91,
			255, 47, 255, 90, 255, 136, 255, 166, 255, 199, 255, 217, 255, 234, 255, 30,
			0, 85, 0, 85, 0, 20, 0, 202, 255, 186, 255, 209, 255, 192, 255, 112, 255,
			29, 255, 17, 255, 79, 255, 131, 255, 142, 255, 168, 255, 245, 255, 67, 0,
			77, 0, 38, 0, 22, 0, 43, 0, 39, 0, 232, 255, 178, 255, 203, 255, 254, 255,
			251, 255, 223, 255, 238, 255, 45, 0, 106, 0, 127, 0, 114, 0, 93, 0, 77, 0,
			24, 0, 186, 255, 122, 255, 126, 255, 176, 255, 243, 255, 57, 0, 154, 0, 4,
			1, 28, 1, 208, 0, 113, 0, 36, 0, 237, 255, 199, 255, 171, 255, 187, 255, 20,
			0, 112, 0, 110, 0, 49, 0, 31, 0, 94, 0, 139, 0, 85, 0, 245, 255, 224, 255,
			34, 0, 92, 0, 61, 0, 237, 255, 222, 255, 30, 0, 89, 0, 67, 0, 238, 255, 192,
			255, 228, 255, 1, 0, 216, 255, 164, 255, 159, 255, 203, 255, 249, 255, 243,
			255, 216, 255, 226, 255, 251, 255, 247, 255, 219, 255, 187, 255, 182, 255,
			220, 255, 253, 255, 242, 255, 193, 255, 166, 255, 185, 255, 204, 255, 201,
			255, 195, 255, 190, 255, 194, 255, 199, 255, 211, 255, 234, 255, 225, 255,
			189, 255, 193, 255, 245, 255, 47, 0, 58, 0, 23, 0, 27, 0, 83, 0, 88, 0, 249,
			255, 155, 255, 160, 255, 229, 255, 10, 0, 246, 255, 219, 255, 2, 0, 86, 0,
			104, 0, 23, 0, 201, 255, 211, 255, 8, 0, 36, 0, 32, 0, 25, 0, 39, 0, 85, 0,
			124, 0, 96, 0, 38, 0, 28, 0, 53, 0, 49, 0, 12, 0, 231, 255, 212, 255, 222,
			255, 252, 255, 12, 0, 16, 0, 33, 0, 56, 0, 70, 0, 84, 0, 89, 0, 71, 0, 47,
			0, 39, 0, 46, 0, 55, 0, 52, 0, 20, 0, 226, 255, 204, 255, 230, 255, 252,
			255, 230, 255, 197, 255, 208, 255, 10, 0, 54, 0, 25, 0, 217, 255, 186, 255,
			220, 255, 0, 0, 228, 255, 197, 255, 222, 255, 14, 0, 37, 0, 29, 0, 16, 0,
			35, 0, 50, 0, 17, 0, 230, 255, 205, 255, 181, 255, 168, 255, 164, 255, 150,
			255, 149, 255, 174, 255, 205, 255, 216, 255, 191, 255, 172, 255, 196, 255
		]
	];

	export default {
		mounted() {
			RecordApp.UniRenderjsRegister(this);
		},
		data() {
			return {
				// address: "94F206C6-42EE-8395-3CE1-3A8F15FA57FD"
				// address: "EE:11:22:33:C1:79"//By Macro
				address: "EE:11:22:33:3D:78", // tz test device ble address
				classicalAddress: "11:11:22:33:3D:78", // tz test device classical address
				iosBleAddress: "A69C430A-92A5-CEDD-FFE1-B7958A028711", // tz test device ios ble address
				// address: "EE:11:22:33:BF:84", // tz xl test device ble address
				// classicalAddress: "11:11:22:33:BF:84" // tz xl test device classical address
				pcmDataReceived: 0,
				heartbeatInterval: null,
				heartbeatStatusIcon: '❌',
				scan_result: [],
				saved_text_filepath: ''
			}
		},
		onLoad() {
			Recorder.a = 1
			this.initBleSDK();
		},
		methods: {
			uniPage__onShow(){ //页面onShow时【必须调用】的函数，传入当前组件this
				RecordApp.UniPageOnShow(this);
			},
			toast(message) {
				plus.nativeUI.toast(message);
			},
			deleteAFile(filename, callback) {
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', { create: true }, (dirEntry) => {
						dirEntry.getFile(filename, {
							create: true
						}, (fileEntry) => {
							fileEntry.remove((entry) => {
								console.log('remove success', entry);
								if (callback) {
									callback();
								}
							}, (e) => {
								console.log('remove error', e);
							});
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			createAFile(filename, callback) {
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', { create: true }, (dirEntry) => {
						dirEntry.getFile(filename, {
							create: true
						}, (fileEntry) => {
							if (callback) {
								callback(fileEntry.fullPath);
							}
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			getAFilePath(filename, callback) {
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', { create: true }, (dirEntry) => {
						dirEntry.getFile(filename, {
							create: true
						}, (fileEntry) => {
							if (callback) {
								callback(fileEntry.fullPath);
							}
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			handleItemClick(item) {
				console.log('handleItemClick', item);
				// this.toast(JSON.stringify(item));
				// set macAddress
				// iOS
				if (plus.os.name === 'iOS') {
					this.iosBleAddress = item.bleAddress;
					this.toast('iOS ble address: ' + this.iosBleAddress);
				} else {
					// Android
					this.address = "";
					// SPP 模式下，scan 的结果没有 bleAddress，只有 deviceMAC
					// 这里把 deviceMAC 作为 address，是为了避开 connect 接口的校验，
					// 没有实际意义
					if (item.bleAddress) {
						this.address = item.bleAddress;
					}
					if (item.deviceMAC) {
						this.address = item.deviceMAC;
					}
					// spp mac address
					this.classicalAddress = item.deviceMAC;
					this.toast('Android ble address: ' + this.address + ' spp mac address: ' + this.classicalAddress);
				}
			},
			classicalRecord() {
				var that = this;
				// 删除录音文件
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
						dirEntry.getFile(filenameStub + '-sys.pcm', {
							create: true
						}, (fileEntry) => {
							fileEntry.remove((entry) => {
								console.log('remove success', entry);
								// 重新创建文件
								dirEntry.getFile(filenameStub + '-sys.pcm', {
									create: true
								}, (fileEntry) => {
									// path of fileEntry
									console.log('fileEntry', fileEntry.fullPath);

									// 开始录音
									that.doClassicalRecord();
								}, (e) => {
									console.log('getFile error', e);
								})
							}, (e) => {
								console.log('remove error', e);
							});
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			doClassicalRecord() {
				RecordApp.UniWebViewActivate(this); //App环境下必须先切换成当前页面WebView
				RecordApp.RequestPermission(()=>{
					console.log("已获得录音权限，可以开始录音了");

					pcmData = []

					RecordApp.UniWebViewActivate(this);
					RecordApp.Start({
						type: 'pcm',
						sampleRate: 16000,
						bitRate: 16,
						audioTrackSet: {
							noiseSuppression: false, echoCancellation: false, autoGainControl: false
						},
						onProcess: (buffers, powerLevel, duration, sampleRate, newBufferIdx, asyncEnd) => {
							console.log("buffers", buffers[0].length, "powerLevel", powerLevel, "duration", duration, "sampleRate", sampleRate, "newBufferIdx", newBufferIdx);
							// console.log("buffers", buffers);
							// buffers 是一个数组，数组长度为 1。buffers[0] 是一个 dict，这里用一个 dict 来表示一个 buffer，index 是 buffer 的序号，data 是 buffer 的数据，数据类型 unsigned short
							// [{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0}]
							// 把 buffers 转化为 Uint8Array
							var bufferDict = buffers[0];
							var bufferArray = [];
							for (var key in bufferDict) {
								// console.log("key", key);
								bufferArray.push(bufferDict[key]);
							}
							// var buffer = new Uint16Array(bufferArray);
							pcmData.push(...bufferArray);
							// json options
							// var options = {
							// 	pcmData: bufferDict,
							// 	sampleRate: sampleRate
							// }
							// var denoised = sdkModule.denoisePcmBufferEx(options);
							// console.log("denoised success", denoised.success, "data len", denoised.data.length);
							// if (denoised.success) {
							// 	pcmData.push(...denoised.data);
							// }
						},
					})
				},(msg,isUserNotAllow)=>{
					if(isUserNotAllow){//用户拒绝了录音权限
						//这里你应当编写代码进行引导用户给录音权限，不同平台分别进行编写
					}
					console.error("请求录音权限失败："+msg);
				});
			},
			stopClassicalRecord() {
				RecordApp.Stop(null, (msg) => {
					console.log("录音结束", msg);

					// 添加 denoised.data 到文件 filepath
					plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
						dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
							dirEntry.getFile(filenameStub + '-sys.pcm', {
								create: true
							}, (fileEntry) => {
								fileEntry.createWriter((writer) => {
									writer.onwrite = function(e) {
										console.log('write success', e);
									};
									writer.onerror = function(e) {
										console.log('write error', e);
									};
									console.log('write ' + pcmData.length);
									writer.write(pcmData.toString());
								}, (e) => {
									console.log('createWriter error', e);
								});
							}, (e) => {
								console.log('getFile error', e);
							})
						}, (e) => {
							console.log('getDirectory error', e);
						})
					}, (e) => {
						console.log('requestFileSystem error', e);
					});
				})
			},
			requestPermissionAndroid(permission) {
				var Build = plus.android.importClass("android.os.Build");
				var MainActivity = plus.android.runtimeMainActivity();
				if (Build.VERSION.SDK_INT >= 23) {
					if (MainActivity.checkSelfPermission(permission) == -1) {
						// Request the permission
						MainActivity.requestPermissions([permission], 1);
						
						// Optional: Add permission result callback
						plus.globalEvent.addEventListener('onRequestPermissionsResult', (e) => {
							if (e.requestCode == 1) { // Match the request code we used
								if (e.grantResults[0] == 0) { // Permission granted
									this.toast("Permission granted");
								} else {
									this.toast("Permission denied");
								}
							}
						});
						
						return false;
					}
				}
				return true;
			},
			requestAudioPermissionIos() {
				// Import required iOS classes
				var AVAudioSession = plus.ios.importClass("AVAudioSession");
				
				// Fallback to older AVAudioSession API for backward compatibility
				var session = AVAudioSession.sharedInstance();
				// check permission
				var permission = session.recordPermission();
				if (permission == 0) {
					this.toast("Recording permission granted");
				} else if (permission == 1) {
					this.toast("Recording permission denied");
				} else {
					// Request permission
					session.requestRecordPermission((granted) => {
						this.handlePermissionResult(granted);
					});
				}
			},
			handlePermissionResult(granted) {
				console.log("handlePermissionResult", granted);
				// if granted is undefined, it means the permission is already granted
				if (granted === undefined) {
					granted = true;
				}
				if (granted) {
					this.toast("Recording permission granted");
				} else {
					this.toast("Recording permission denied");
					
					// Open app settings if permission denied
					var NSURL = plus.ios.importClass('NSURL');
					var UIApplication = plus.ios.importClass('UIApplication');
					
					var settingsUrl = NSURL.URLWithString('app-settings:');
					var application = UIApplication.sharedApplication();
					
					if (application.canOpenURL(settingsUrl)) {
						application.openURL(settingsUrl);
					}
				}
			},
			requestAudioRecordPermission() {
				if (plus.os.name === 'iOS') {
					this.requestAudioPermissionIos();
				} else {
					var Manifest = plus.android.importClass("android.Manifest");
					this.requestPermissionAndroid(Manifest.permission.RECORD_AUDIO);
				}
			},
			startNativeRecord() {
				this.requestAudioRecordPermission();

				var that = this;
				this.deleteAFile(filenameStub + '-sys-raw.pcm', () => {
					that.deleteAFile(filenameStub + '-sys-raw-denoise.pcm', () => {
						that.createAFile(filenameStub + '-sys-raw-denoise.pcm', (filepath) => {
							console.log('createAFile', filepath);
							plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
								that.getAFilePath(filenameStub + '-sys-raw.pcm', (fullPath) => {
									var denoiseFilepath = fullPath.replace('-raw.pcm', '-raw-denoise.pcm');
									sdkModule.startAudioRecord({
										pcmPath: fullPath // 调试用，如果传入 ""，则不保存文件
									}, (ret) => {
										console.log('startAudioRecord', ret.msg)
										if (ret.data && ret.data.length > 0) {
											console.log('startAudioRecord', ret.data.length)
											// console.log('startAudioRecord', ret.data)
											// convert to Uint8Array
											// var buffer = new Uint8Array(ret.data);
											// console.log('startAudioRecord', buffer.length)
											var denoiseResult = sdkModule.denoisePcmBufferEx({
												sampleRate: 16000,
												pcmData: ret.data,
												pcmPath: denoiseFilepath // 调试用，如果传入 ""，则不保存文件
											})
											// check if denoiseResult is undefined
											if (denoiseResult === undefined) {
												console.log('denoisePcmBufferEx', 'denoiseResult is undefined')
											} else {
												console.log('denoisePcmBufferEx', denoiseResult.success, denoiseResult.data.length)
											}
										}
									})
								})
							})
						})
					})
				})
			},
			stopNativeRecord() {
				sdkModule.stopAudioRecord((ret) => {
					console.log('stopAudioRecord', ret.msg)
					// toast
					this.toast(ret.msg);
				})
			},
			exportNativeRecordFile() {
				this.doExportFile(filenameStub + '-sys-raw.pcm');
			},
			exportNativeRecordDenoisedFile() {
				this.doExportFile(filenameStub + '-sys-raw-denoise.pcm');
			},
			exportFile() {
				this.doExportFile(filenameStub + '.pcm');
			},
			exportPcmFile() {
				this.doExportFile(filenameStub + '-raw.pcm');
			},
			exportPcmLeftFile() {
				this.doExportFile(filenameStub + '-left-raw.pcm');
			},
			exportPcmRightFile() {
				this.doExportFile(filenameStub + '-right-raw.pcm');
			},
			exportPcmLeftDenoiseFile() {
				this.doExportFile(filenameStub + '-left-raw-denoise.pcm');
			},
			exportPcmRightDenoiseFile() {
				this.doExportFile(filenameStub + '-right-raw-denoise.pcm');
			},
			doExportFile(filename) {
				var that = this;
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
						dirEntry.getFile(filename, {
							create: true
						}, (fileEntry) => {
							// path of fileEntry
							console.log('fileEntry', fileEntry.fullPath);
							// that.exportFile(fileEntry.fullPath)
							if (plus.os.name === 'iOS') {
								uni.openDocument({
									filePath: fileEntry.fullPath,
									fileType: 'wav',
									success: function(res) {
										console.log('open document success');
									},
									fail: function(err) {
										console.log('open document fail', err);
									}
								})
							} 
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			// export file
			exportFilePath(filepath) {
				console.log('exportFile', filepath);
				// if the OS is iOS, use UIActivityViewController to share the file
				if (plus.os.name === 'iOS') {
					var UIActivityViewController = plus.ios.importClass('UIActivityViewController');
					var NSURL = plus.ios.importClass('NSURL');

					var url = NSURL.fileURLWithPath(filepath, false);
					var activityItems = UIActivityViewController.alloc().initWithActivityItems([url], null);
					var app = plus.ios.invoke('UIApplication', 'sharedApplication');
					var window = app.keyWindow;
					var rootViewController = window.rootViewController;
					rootViewController.presentViewController(activityItems, true, null);
				} else {
					// if the OS is Android, use Intent.ACTION_SEND to share the file
					var Intent = plus.android.importClass('android.content.Intent');
					var Uri = plus.android.importClass('android.net.Uri');
					var File = plus.android.importClass('java.io.File');
					var intent = new Intent();
					intent.setAction(Intent.ACTION_SEND);
					var uri = Uri.fromFile(new File(filepath));
					intent.putExtra(Intent.EXTRA_STREAM, uri);
					intent.setType('*/*');
					plus.android.runtimeMainActivity().startActivity(Intent.createChooser(intent, 'Share'));
				}
			},
			getMacAddress() {
				var platform = uni.getSystemInfoSync().platform;
				// Android
				if (platform === 'android') {
					return this.address;
				} else if (platform === 'ios') {
					// iOS
					return this.iosBleAddress; // tz test device ios ble address
				}
			},
			microphoneRecording() {
				// 1. 初始化
				sdkModule.init({
					enableDenoise: true
				}, (ret) => {
					console.log('init', ret);

					// 如果是 iOS 平台，deviceProtocol 设置为 1
					// 如果是 Android 平台，deviceProtocol 设置为 16。Android 平台上 1 也能工作。
					var platform = uni.getSystemInfoSync().platform;
					if (platform === 'android') {
						deviceProtocol = 16;
					} else if (platform === 'ios') {
						deviceProtocol = 1;
					}

					//不需要设置的参数请注释掉
					sdkModule.initBleSDK({
						deviceProtocol: deviceProtocol // 1:BLE, 16:SPP，初始化后不能随便修改
					}, (ret) => {
						//扫描回调结果
						console.log(ret)
						this.toast(JSON.stringify(ret));
						// 1.5 断开连接
						sdkModule.disconnect((ret) => {
							console.log('disconnect', ret);
							this.toast(JSON.stringify(ret));
							// 2. 连接设备
							sdkModule.connect({
								macAddress: this.getMacAddress(),
								deviceMac: this.classicalAddress
							}, (ret) => {
								console.log("connect", ret)
								this.toast(JSON.stringify(ret));

								// 2.5 unregister callback
								sdkModule.unRegisterDataCallback();

								// 3. 注册回调
								sdkModule.registerDataCallback((ret) => {
									console.log('callback', ret)
									// this.toast(JSON.stringify(ret));
									// if ret.data is "5bb500", it's a heartbeat response
									if (ret.data === '5bb500') {
										if (this.heartbeatStatusIcon === '✅') {
											this.heartbeatStatusIcon = '❌'
										} else {
											this.heartbeatStatusIcon = '✅'
										}
									}
								});

								// 4. 开启定时心跳
								sdkModule.startSendBLEHeartbeatPack({
									timeDuration: 2000
								}, (ret) => {
									console.log('startSendBLEHeartbeatPack', ret)
								});

								// 5. 开始录音
								// 创建一个文件，用于保存录音数据
								isRecording = true
								pcmData = []
								sdkModule.sceneRecord(
									(ret) => {
										// console.log('record', ret)
										console.log('record', ret.success, ret.data.length)
										// this.toast('record ' + ret.success + ' ' + ret.data.length)
										// append ret.data to pcmData
										pcmData.push(...ret.data)
										this.pcmDataReceived += ret.data.length
								});
							});
						});
					});

				});
			},
			//初始化
			initBleSDK() {
				// testModule.init();
				console.log("initBleSDK os", plus.os.name);
				if (plus.os.name === 'iOS') {
					// iOS 平台
					sdkModule.init({
						enableDenoise: true
					});
				} else {
					// Android 平台
					// public Long init(boolean isNewDecoder, boolean enableDenoise, boolean debug)
					sdkModule.init({
						enableDenoise: true
					}, (ret) => {
						console.log('init', ret);
					});
				}

				// 如果是 iOS 平台，deviceProtocol 设置为 1
				// 如果是 Android 平台，deviceProtocol 设置为 16。Android 平台上 1 也能工作。
				var platform = uni.getSystemInfoSync().platform;
				if (platform === 'android') {
					deviceProtocol = 16;
				} else if (platform === 'ios') {
					deviceProtocol = 1;
				}

				//不需要设置的参数请注释掉
				sdkModule.initBleSDK({
					deviceProtocol: deviceProtocol // 1:BLE, 16:SPP，初始化后不能随便修改
				}, (ret) => {
					//扫描回调结果
					console.log(ret)
					this.toast(JSON.stringify(ret));
				});
			},
			isBlueEnable() {
				var ret = sdkModule.isBlueEnable();
				console.log(ret)
				this.toast(JSON.stringify(ret));
			},
			enableBluetooth() {
				sdkModule.enableBluetooth((ret) => {
					//扫描回调结果
					console.log(ret)
					this.toast(JSON.stringify(ret));
				});
			},
			disableBluetooth() {
				sdkModule.disableBluetooth((ret) => {
					//扫描回调结果
					console.log(ret)
					this.toast(JSON.stringify(ret));
				});
			},
			//开始扫描
			startScan() {
				this.scan_result = []
				sdkModule.startScan({
					//暂时未启动参数查询，由SDK内进行过滤筛选
				}, (ret) => {
					//扫描回调结果
					console.log("startScan", ret)
					// this.toast(JSON.stringify(ret));
					if (ret.success) {
						// append to scan_result
						this.scan_result.push(ret.data);
						if (ret.data.deviceId == this.getMacAddress()) {
							console.log('检测到指定设备', ret)
							this.toast(JSON.stringify(ret));
						} else {
							console.log('检测到其他设备')
						}
					}
				});
			},
			//停止扫描
			stopScan() {
				sdkModule.stopScan();
			},
			connect() {
				this.toast('开始连接 1');
				sdkModule.disconnect((ret) => {
					console.log('disconnect', ret);
					setTimeout(() => {
						this.toast('开始连接 2');
						var connectOptions = {
							macAddress: this.getMacAddress(),
							deviceMac: this.classicalAddress
						};
						console.log('connectOptions', connectOptions);
						sdkModule.connect(connectOptions, (ret) => {
							//扫描回调结果
							console.log("connect",ret)
							this.toast(JSON.stringify(ret));
						});
					}, 3000);
				})
			},
			disconnect() {
				sdkModule.disconnect((ret) => {
					//扫描回调结果
					console.log(ret)
					this.toast(JSON.stringify(ret));
				});
			},
			startHeartBeat() {
				sdkModule.unRegisterDataCallback();
				this.registerDataCallback();
				sdkModule.startSendBLEHeartbeatPack({
					timeDuration: 2000
				}, (ret) => {
					console.log('startSendBLEHeartbeatPack', ret)
				});
			},
			stopHeartBeat() {
				sdkModule.stopSendBLEHeartbeatPack((ret) => {
					console.log('stopSendBLEHeartbeatPack', ret)
				});
			},
			startOTA() {
				// 断开业务连接
				sdkModule.disconnect((ret) => {
					//扫描回调结果
					console.log("disconnect", ret)
					this.toast(JSON.stringify(ret));

					console.log("deviceProtocol", deviceProtocol);
					this.toast("deviceProtocol: " + deviceProtocol);
					var connectFun = sdkModule.connect;
					if (deviceProtocol === 16) {
						// SPP 模式
						connectFun = sdkModule.connectForOTAInSpp;
					}
					// 连接设备
					connectFun({
						/**
						 * {"success":true,"msg":"onLeScan","data":{"mBleAddress":"1AF92E22-C653-272E-06AF-46D92E4B8963","mDeviceType":2,"mBleName":"Fuwinda 6199"}}
						 */
						macAddress: this.getMacAddress(),
						deviceMac: this.classicalAddress
					}, (ret) => {
						//扫描回调结果
						console.log("connect", ret)
						this.toast(JSON.stringify(ret));

						// 连接失败，直接返回
						if (!ret.success) {
							return;
						}

						// 调用异步方法
						var filePath = plus.io.convertLocalFileSystemURL('/static/HTS283_BS685HL_2500YP_SW_V3.2_release_converted.bin') //pdf文件所在路径
						console.log(filePath)
						sdkModule.startOTA({
							localPath: filePath, //mac地址
							mClearUserData: false, //清楚用户数据
							mUpdateBtAddress: false, //是否更新蓝牙地址
							btAddress: '',//新的蓝牙地址，必须满足规则才生效
							mUpdateBtName: false, //是否更新蓝牙名称
							btName: '',//蓝牙名称，不为空才生效
							mUpdateBleAddress: false, //是否更新BLE地址
							bleAddress: '',//新的BLE蓝牙地址，必须满足规则才生效
							mUpdateBleName: false, //是否更新BLE蓝牙名称
							bleName: '', //BLE蓝牙名称，不为空才生效
							breakPoint: 0 //0不断点续传，1支持断点续传
						}, (ret) => {
							//扫描回调结果
							console.log("startOTA", ret)
							this.toast(JSON.stringify(ret));

							// OTA 成功后，重连
							// setTimeout(() => {
							// 	// OTA 结束后，断开连接。重新建立业务连接
							// 	sdkModule.disconnect((ret) => {
							// 		//扫描回调结果
							// 		console.log("disconnect", ret)
							// 		// modal.toast({
							// 		// 	//发送操作结果
							// 		// 	message: ret,
							// 		// 	duration: 1.5
							// 		// });

							// 		// 重新连接
							// 		sdkModule.connect({
							// 			/**
							// 			 * {"success":true,"msg":"onLeScan","data":{"mBleAddress":"1AF92E22-C653-272E-06AF-46D92E4B8963","mDeviceType":2,"mBleName":"Fuwinda 6199"}}
							// 			 */
							// 			macAddress: this.getMacAddress(),
							// 			deviceMac: this.classicalAddress
							// 		}, (ret) => {
							// 			//扫描回调结果
							// 			console.log("connect", ret)
							// 			// modal.toast({
							// 			// 	//发送操作结果
							// 			// 	message: ret,
							// 			// 	duration: 1.5
							// 			// });
							// 		});
							// 	});
							// }, 3000); // 等待耳机重启完成
						});
					});
				});
			},
			cancelOTA() {
				sdkModule.cancelOTA((ret) => {
					//扫描回调结果
					console.log(ret)
					this.toast(JSON.stringify(ret));
				});
			},
			startCallingRecord() {
				this.startRecord(1)
			},
			startMicrophoneRecord() {
				this.startRecord(2)
			},
			startRecord(mode) {
				var func = sdkModule.startRecord
				if (mode === 1) {
					func = sdkModule.startRecord
				} else if (mode === 2) {
					func = sdkModule.sceneRecord
				} else if (mode === 3) {
					func = sdkModule.audioVideoRecord
				}
				// 创建一个文件，用于保存录音数据
				isRecording = true
				pcmData = []
				sdkModule.startRecord(
					(ret) => {
						// console.log('record', ret)
						console.log('record', ret.success, ret.data.length)
						// this.toast('record ' + ret.success + ' ' + ret.data.length)
						// append ret.data to pcmData
						pcmData.push(...ret.data)
						this.pcmDataReceived += ret.data.length
					});
			},
			stopCallingRecord() {
				sdkModule.stopRecord((ret) => {
					console.log('stopCallingRecord', ret)
					this.toast(JSON.stringify(ret))

					// delay 5s to make sure the record is finished
					setTimeout(() => {
						isRecording = false

						// 将 pcmData 转为 Uint8Array
						var pcmDataArray = new Uint8Array(pcmData)
						// console.log('pcmDataArray', pcmDataArray)
						// 写入 plugin-demo-pcm.wave 文件
						console.log('write file', pcmDataArray.length);
						// check is plus ready
						if (!plus) {
							console.log('plus is not ready');
							return;
						}
						var that = this;
						plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
							dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
								dirEntry.getFile(filenameStub + '.pcm', {
									create: true
								}, (fileEntry) => {
									fileEntry.createWriter((writer) => {
										writer.onwrite = function(e) {
											console.log('write success', e);
											// export file
											// path on android: /storage/emulated/0/Android/data/com.android.UniPlugin/documents/pcm/plugin-demo-pcm.pcm
											// path of fileEntry
											console.log('fileEntry', fileEntry.fullPath);
											that.toast('write success ' + fileEntry.fullPath);
											that.saved_text_filepath = fileEntry.fullPath;
											// that.exportFile(fileEntry.fullPath)
										};
										writer.onerror = function(e) {
											console.log('write error', e);
										};
										console.log('write ' + pcmDataArray.length);
										// FIXME: 这里写二进制会失败，文件大小为0
										// 暂时写入字符串，然后用工具转为二进制
										// convert_comma_split_array_to_raw.py: 转化为二进制文件
										// split-channels.py: 分离左右声道
										var str = pcmDataArray.toString();
										// console.log('str', len(s));
										writer.write(str);
									}, (e) => {
										console.log('createWriter error', e);
										that.toast('createWriter error ' + JSON.stringify(e));
									});
								}, (e) => {
									console.log('getFile error', e);
									that.toast('getFile error ' + JSON.stringify(e));
								})
							}, (e) => {
								console.log('getDirectory error', e);
								that.toast('getDirectory error ' + JSON.stringify(e));
							})
						}, (e) => {
							console.log('requestFileSystem error', e);
							that.toast('requestFileSystem error ' + JSON.stringify(e));
						});
					}, 5000);
				})
			},
			sendTestData2() {
				sdkModule.write({
					hexStr: '5aa500'
				}, (ret) => {
					//扫描回调结果
					console.log(ret)
					this.toast(JSON.stringify(ret));
				});
			},
			registerDataCallback() {
				sdkModule.registerDataCallback((ret) => {
					console.log('callback', ret)
					// this.toast(JSON.stringify(ret));
					// if ret.data is "5bb500", it's a heartbeat response
					if (ret.data === '5bb500') {
						if (this.heartbeatStatusIcon === '✅') {
							this.heartbeatStatusIcon = '❌'
						} else {
							this.heartbeatStatusIcon = '✅'
						}
					}
				});
			},
			unRegisterDataCallback() {
				sdkModule.unRegisterDataCallback();
			},
			decoderOpus() {
				var ret = sdkModule.decoderOpus([0x00, 0x00, 0x00]);
				console.log(ret)
				//ret为[0x00, 0x00, 0x00]数组
			},
			waveToPcm() {
				sdkModule.convertWaveToPcm({
					wavePath: 'pcm/plugin-demo-pcm.wav',
					pcmPath: 'pcm/plugin-demo-pcm.pcm'
				}, (ret) => {
					console.log(ret)
				});
			},
			pcmToWav() {
				var that = this;
				// raw pcm file path
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
						dirEntry.getFile(filenameStub + '-raw.pcm', {
							create: true
						}, (fileEntry) => {
							var pcmFilepath = fileEntry.fullPath;
							console.log('pcmFilepath', pcmFilepath);
							var wavFilepath = pcmFilepath.replace('.pcm', '-wav.wav');
							sdkModule.convertPcmToWave({
								pcmPath: pcmFilepath,
								wavPath: wavFilepath
							}, (ret) => {
								console.log(ret)
								that.toast(JSON.stringify(ret));
							});
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			textToRawPcm() {
				var textFilename = filenameStub + '.pcm';
				this.doTextToRawPcm(textFilename);
			},
			doTextToRawPcm(textFilename, successCallback) {
				var that = this;
				// string array file path
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
						dirEntry.getFile(textFilename, {
							create: true
						}, (fileEntry) => {
							var textFilepath = fileEntry.fullPath;
							console.log('textFilepath', textFilepath);
							var pcmFilepath = textFilepath.replace('.pcm', '-raw.pcm');
							sdkModule.convertStringArrayFileToRawFile({
								textPath: textFilepath,
								pcmPath: pcmFilepath
							}, (ret) => {
								console.log(ret)
								that.toast(JSON.stringify(ret));
								if (successCallback) {
									successCallback();
								}
							});
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			splitChannels() {
				this.doSplitChannels(filenameStub);
			},
			doSplitChannels(myFilenameStub, successCallback) {
				console.log('splitChannels', myFilenameStub + '.pcm');
				// split string array pcm file to left and right channel
				var that = this;
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
						dirEntry.getFile(myFilenameStub + '.pcm', {
							create: true
						}, (fileEntry) => {
							// read file
							fileEntry.file((file) => {
								var reader = new plus.io.FileReader();
								reader.onloadend = function(e) {
									var pcmData = e.target.result;
									console.log('pcmData', pcmData.length);
									// split pcmData by comma
									var pcmArray = pcmData.split(',');
									console.log('pcmArray', pcmArray.length);
									// split pcmArray to left and right channel
									var leftChannel = [];
									var rightChannel = [];
									// left channel: 0, 1, 4, 5, 8, 9...
									// right channel: 2, 3, 6, 7, 10, 11...
									for (var i = 0; i < pcmArray.length; i+=4) {
										leftChannel.push(pcmArray[i]);
										leftChannel.push(pcmArray[i + 1]);
										rightChannel.push(pcmArray[i + 2]);
										rightChannel.push(pcmArray[i + 3]);
									}

									// write leftChannel to left.pcm
									var leftChannelStr = leftChannel.join(',');
									console.log('leftChannelStr', leftChannelStr.length);
									var that2 = that;
									that.writeChannelDataToFile(that, leftChannelStr, myFilenameStub, 'left', () => {
										console.log('write left success');
										that2.toast('write left success');

										// convert left string array file to raw file
										that2.doTextToRawPcm(myFilenameStub + '-left.pcm', () => {
											console.log('convert left success', myFilenameStub + '-left.pcm');
											that2.toast('convert left success ' + myFilenameStub + '-left.pcm');

											// write rightChannel to right.pcm
											var rightChannelStr = rightChannel.join(',');
											console.log('rightChannelStr', rightChannelStr.length);
											var that3 = that2;
											that2.writeChannelDataToFile(that2, rightChannelStr, myFilenameStub, 'right', () => {
												console.log('write right success');
												that3.toast('write right success');

												// convert right string array file to raw file
												that3.doTextToRawPcm(myFilenameStub + '-right.pcm', () => {
													console.log('convert right success', myFilenameStub + '-right.pcm');
													that3.toast('convert right success ' + myFilenameStub + '-right.pcm');

													if (successCallback) {
														successCallback();
													}
												});
											});
										});
									});
								};
								reader.readAsText(file);
							}, (e) => {
								console.log('file error', e);
							});
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			splitChannelsTest() {
				//
				// 生成一个长度为 200 的测试文件，用于测试分离左右声道
				// 文件内容为：0,1,2,3,4...199
				// 然后拆分左右声道，检查左声道文件和右声道文件是否正确
				// 左声道的内容应该为：0,1,4,5,8,9...
				// 右声道的内容应该为：2,3,6,7,10,11...
				//
				var myFilenameStub = 'plugin-demo-split-channels-test';
				// generate test file
				var testFileContent = '';
				for (var i = 0; i < 200; i++) {
					testFileContent += i + ',';
				}
				// 去掉最后一个逗号
				testFileContent = testFileContent.substring(0, testFileContent.length - 1);
				console.log('testFileContent', testFileContent.length);
				var that = this;
				// 写入文件 myFilenameStub + '.pcm'
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', {create:true}, (dirEntry) =>{
						dirEntry.getFile(myFilenameStub + '.pcm', {
							create: true
						}, (fileEntry) => {
							fileEntry.createWriter((writer) => {
								writer.onwrite = function(e) {
									console.log('write success', e);
									var that2 = that;
									// split channels
									that.doSplitChannels(myFilenameStub, () => {
										console.log('split channels success');

										//
										// 检查左声道文件和右声道文件是否正确
										//

										// check left channel
										plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
											dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
												dirEntry.getFile(myFilenameStub + '-left.pcm', {
													create: true
												}, (fileEntry) => {
													// read file
													fileEntry.file((file) => {
														var reader = new plus.io.FileReader();
														reader.onloadend = function(e) {
															var pcmData = e.target.result;
															console.log('pcmData', pcmData.length);
															// split pcmData by comma
															var pcmArray = pcmData.split(',');
															console.log('pcmArray', pcmArray.length);

															// check left channel
															// 左声道的内容应该为：0,1,4,5,8,9...
															var valPrevious = '0'
															for (var i = 0; i < pcmArray.length; i++) {
																var valExpected = ''
																if (i % 2 === 0) {
																	valExpected = '' + (i * 2);
																} else {
																	// valPrevious to int, and add 1
																	valExpected = '' + (parseInt(valPrevious) + 1);
																}
																if (pcmArray[i] !== valExpected) {
																	console.log('left channel error', i, pcmArray[i], valExpected);
																	break;
																}
																valPrevious = pcmArray[i];
															}
															if (i === pcmArray.length) {
																console.log('left channel success');
																that2.toast('left channel success');
															}
														};
														reader.readAsText(file);
													}, (e) => {
														console.log('file error', e);
													});
												}, (e) => {
													console.log('getFile error', e);
												})
											}, (e) => {
												console.log('getDirectory error', e);
											})
										}, (e) => {
											console.log('requestFileSystem error', e);
										});

										// check right channel
										plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
											dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
												dirEntry.getFile(myFilenameStub + '-right.pcm', {
													create: true
												}, (fileEntry) => {
													// read file
													fileEntry.file((file) => {
														var reader = new plus.io.FileReader();
														reader.onloadend = function(e) {
															var pcmData = e.target.result;
															console.log('pcmData', pcmData.length);
															// split pcmData by comma
															var pcmArray = pcmData.split(',');
															console.log('pcmArray', pcmArray.length);

															// check right channel
															// 右声道的内容应该为：2,3,6,7,10,11...
															var valPrevious = '2'
															for (var i = 0; i < pcmArray.length; i++) {
																var valExpected = ''
																if (i % 2 === 0) {
																	valExpected = '' + (i * 2 + 2);
																} else {
																	// valPrevious to int, and add 1
																	valExpected = '' + (parseInt(valPrevious) + 1);
																}
																if (pcmArray[i] !== valExpected) {
																	console.log('right channel error', i, pcmArray[i], valExpected);
																	break;
																}
																valPrevious = pcmArray[i];
															}
															if (i === pcmArray.length) {
																console.log('right channel success');
																that2.toast('right channel success');
															}
														};
														reader.readAsText(file);
													}, (e) => {
														console.log('file error', e);
													});
												}, (e) => {
													console.log('getFile error', e);
												})
											}, (e) => {
												console.log('getDirectory error', e);
											})
										}, (e) => {
											console.log('requestFileSystem error', e);
										});
									});
								};
								writer.onerror = function(e) {
									console.log('write error', e);
								};
								console.log('write ' + testFileContent.length);
								writer.write(testFileContent);
							}, (e) => {
								console.log('createWriter error', e);
							})
						}, (e) => {
							console.log('getFile error', e);
						})
					})
				})
			},
			denoisePcmFile() {
				var that = this;
				this.doDenoisePcmFile(filenameStub + '-left-raw.pcm', () => {
					console.log('denoise left success');
					that.toast('denoise left success');

					var that2 = that;
					that.doDenoisePcmFile(filenameStub + '-right-raw.pcm', () => {
						that2.toast('denoise success');
					});
				});
			},
			doDenoisePcmFile(filename, successCallback) {
				this.toast('denoise ' + filename);
				var that = this;
				// denoise left channel pcm file
				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', {create:true}, (dirEntry) => {
						dirEntry.getFile(filename, {
							create: true
						}, (fileEntry) => {
							var pcmFilepath = fileEntry.fullPath;
							console.log('pcmFilepath', pcmFilepath);
							var denoiseFilepath = pcmFilepath.replace('.pcm', '-denoise.pcm');
							sdkModule.denoisePcmFile({
								pcmPath: pcmFilepath,
								denoisePath: denoiseFilepath
							}, (ret) => {
								console.log(ret)
								that.toast(JSON.stringify(ret));
								if (successCallback) {
									successCallback();
								}
							});
						}, (e) => {
							console.log('getFile error', e);
						})
					}, (e) => {
						console.log('getDirectory error', e);
					})
				}, (e) => {
					console.log('requestFileSystem error', e);
				});
			},
			writeChannelDataToFile(that, channelDataStr, myFilenameStub, side, successCallback) {
				console.log('writeChannelDataToFile', side, channelDataStr.length);

				plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS, (dir) => {
					dir.root.getDirectory('pcm', { create: true }, (dirEntry) => {
					dirEntry.getFile(myFilenameStub + '-'+ side + '.pcm', {
						create: true
					}, (fileEntry) => {
						fileEntry.createWriter((writer) => {
							writer.onwrite=function(e) {
								console.log('write success', e)
								// export file
								// path on android: /storage/emulated/0/Android/data/com.android.UniPlugin/documents/pcm/plugin-demo-pcm.pcm
								// path of fileEntry
								console.log('fileEntry', fileEntry.fullPath)
								that.toast('write success '+fileEntry.fullPath)
								// that.exportFile(fileEntry.fullPath)
								if (successCallback) {
									successCallback()
								}
							}
							writer.onerror=function(e) {
								console.log('write error', e)
							}
							console.log('write '+channelDataStr.length)
							writer.write(channelDataStr)
						}, (e) => {
							console.log('createWriter error', e)
							that.toast('createWriter error '+JSON.stringify(e))
						})
					}, (e) => {
						console.log('getFile error', e)
						that.toast('getFile error '+JSON.stringify(e))
					})
					}, (e) => {
						console.log('getDirectory error', e)
						that.toast('getDirectory error '+JSON.stringify(e))
					})
				}, (e) => {
					console.log('requestFileSystem error', e)
					that.toast('requestFileSystem error '+JSON.stringify(e))
				})
			},
			testDenoisePcm16k() {
				var remainedData = [];

				// iterate testData as an array

				// iterate testData as an array
				for (var index in testData) {
					// append data to remainedData
					remainedData.push(...testData[index]);

					console.log('remainedData', remainedData);

					//
					// get first 1280 * 2 bytes in remainedData,
					// then remove them from remainedData
					//

					// 1280 * 2 bytes = 1280 samples * 2 bytes/sample
					var dataLength = 1280 * 2;
					var data = remainedData.slice(0, dataLength);
					remainedData = remainedData.slice(dataLength);

					console.log('testDenoisePcm16k', testData);
					sdkModule.denoisePcmBufferEx({
						sampleRate: 16000,
						pcmData: data,
						pcmPath: "" // 调试用，如果传入 ""，则不保存文件
					}, (ret) => {
						console.log(ret)
					});

					console.log('remainedData', remainedData.length);
				}
			}
		},
	}
</script>

<!-- #ifdef APP -->
<script module="yourModuleName" lang="renderjs"> //此模块内部只能用选项式API风格，vue2、vue3均可用，请照抄这段代码；不可改成setup组合式API风格，否则可能不能import vue导致编译失败
/**需要编译成App时，你需要添加一个renderjs模块，然后一模一样的import上面那些js（微信的js除外）
    ，因为App中默认是在renderjs（WebView）中进行录音和音频编码**/
import 'recorder-core'
import RecordApp from 'recorder-core/src/app-support/app'
import '../../uni_modules/Recorder-UniCore/app-uni-support.js' //renderjs中似乎不支持"@/"打头的路径，如果编译路径错误请改正路径即可

//按需引入你需要的录音格式支持文件，和插件
import 'recorder-core/src/engine/mp3'
import 'recorder-core/src/engine/mp3-engine' 

import 'recorder-core/src/extensions/waveview'

export default {
    mounted(){
        //App的renderjs必须调用的函数，传入当前模块this
        RecordApp.UniRenderjsRegister(this);
    },
    methods: {
        //这里定义的方法，在逻辑层中可通过 RecordApp.UniWebViewVueCall(this,'this.xxxFunc()') 直接调用
        //调用逻辑层的方法，请直接用 this.$ownerInstance.callMethod("xxxFunc",{args}) 调用，二进制数据需转成base64来传递
    }
}
</script>
<!-- #endif -->